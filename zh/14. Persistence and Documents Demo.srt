1
00:00:00,401 --> 00:00:04,603
[音乐]

2
00:00:04,671 --> 00:00:09,474
斯坦福大学。 >>好的，

3
00:00:09,543 --> 00:00:14,046
好吧，欢迎来到斯坦福大学CS193P讲座14，

4
00:00:14,114 --> 00:00:18,884
2017年秋天，18。所以，我要完成这件事

5
00:00:18,953 --> 00:00:22,254
我们上次有关于这些文件，我希望能够

6
00:00:22,323 --> 00:00:24,489
最后一次完成了。所以我们有点急

7
00:00:24,558 --> 00:00:27,025
这一次，特别是因为我们会被踢

8
00:00:27,093 --> 00:00:29,794
之后再次出现中期权利。然后我会去的

9
00:00:29,863 --> 00:00:32,364
启动一个长期演示，基本上会演示

10
00:00:32,432 --> 00:00:35,300
所有我们周一谈到的东西。

11
00:00:35,368 --> 00:00:39,504
好，所以星期一我们做了所有的事情，以便我们

12
00:00:39,573 --> 00:00:43,075
可以很容易地采取我们的文件为基础的应用程序，

13
00:00:43,143 --> 00:00:45,743
并将其存储在文档中。我们一路走过

14
00:00:45,812 --> 00:00:49,314
让UIDocument将文件写入文件系统。

15
00:00:49,383 --> 00:00:52,751
现在我们要在前面添加一个非常酷的UI层

16
00:00:52,819 --> 00:00:55,754
这样，用户可以选择他们想要的文件。

17
00:00:55,822 --> 00:00:59,024
重命名它们，将它们移动到所有内部

18
00:00:59,093 --> 00:01:02,327
应用程序。而对于这个UI，你可以看到截图，

19
00:01:02,395 --> 00:01:05,597
看起来很像iOS 11中的文件应用程序。事实上，

20
00:01:05,666 --> 00:01:09,034
iOS 11中的文件应用程序可能只是非常薄

21
00:01:09,103 --> 00:01:12,104
此UI或此API的顶层，

22
00:01:12,172 --> 00:01:15,340
UIDocumentBrowserViewControl-

23
00:01:15,408 --> 00:01:17,709
LER。那么这个东西是如何工作的，

24
00:01:17,777 --> 00:01:20,378
这个视图控制器？那么，最重要的是

25
00:01:20,447 --> 00:01:22,447
理解是它只是一个视图控制器，但是

26
00:01:22,516 --> 00:01:25,183
它总是根视图控制器

27
00:01:25,251 --> 00:01:27,452
你的申请。换句话说，在你的故事板中，

28
00:01:27,521 --> 00:01:30,122
它总是得到指向它的小箭头。和

29
00:01:30,190 --> 00:01:31,323
当你运行你的应用程序时，

30
00:01:31,391 --> 00:01:33,926
这将是视图控制器用户首先看到的。

31
00:01:33,994 --> 00:01:37,062
然后，他们会选择他们想要的任何文件，并且

32
00:01:37,131 --> 00:01:38,797
那么你的UI将会接管。

33
00:01:38,865 --> 00:01:41,166
你的视图控制器会出现在这个之前，

34
00:01:41,234 --> 00:01:43,769
做任何事情来展示你的文档。好，如此

35
00:01:43,837 --> 00:01:47,305
这是这件事的基本架构。

36
00:01:47,374 --> 00:01:50,676
有一件事告诉这个小文件很重要

37
00:01:50,744 --> 00:01:54,446
浏览器视图控制器是您打开的文件类型，

38
00:01:54,514 --> 00:01:56,080
你可以在你的项目设置上做到这一点。所以

39
00:01:56,149 --> 00:01:59,451
如果您转到信息选项卡下的项目设置，

40
00:01:59,519 --> 00:02:01,686
你必须选择你的目标，而不是项目，但是

41
00:02:01,755 --> 00:02:04,155
目标。转到信息选项卡，然后在那里，

42
00:02:04,224 --> 00:02:06,225
有一个叫做文档类型的小节。

43
00:02:06,293 --> 00:02:08,793
那么，这是您打开的文档类型，以及

44
00:02:08,862 --> 00:02:09,961
你只需填写这个。

45
00:02:10,030 --> 00:02:12,564
当你填写这一点时，你可以有多种类型

46
00:02:12,633 --> 00:02:14,800
形式，就像那个。例如，在这里，

47
00:02:14,868 --> 00:02:17,468
我已经展示了如何让JSON文件成为一种文件

48
00:02:17,537 --> 00:02:20,505
你打开，在那里很简单。

49
00:02:20,574 --> 00:02:23,108
底部的小东西BundleType

50
00:02:23,177 --> 00:02:25,644
和HandleRank，基本上只是说，好吧，

51
00:02:25,712 --> 00:02:28,613
这是否像您打开的主要文件类型？

52
00:02:28,682 --> 00:02:32,217
你是这种类型的文件的所有者，还是只是一些？

53
00:02:32,285 --> 00:02:35,587
其他类型，你可以，你知道如何打开，

54
00:02:35,656 --> 00:02:38,456
等等。现在，您可以拥有自己的文档类型，

55
00:02:38,525 --> 00:02:39,824
例如，对于emojiart，

56
00:02:39,893 --> 00:02:42,594
由于时间限制，我今天不会得到它。

57
00:02:42,662 --> 00:02:46,531
但是，emojiart真的想拥有自己的文档类型，

58
00:02:46,599 --> 00:02:50,002
.emojiart或类似的东西。你把它放在里面

59
00:02:50,070 --> 00:02:52,704
文档类型下面的部分，

60
00:02:52,772 --> 00:02:56,108
称为导出的UTI，UTI代表通用类型和

61
00:02:56,176 --> 00:02:58,610
标识符。你可以发明你自己的UTI，

62
00:02:58,679 --> 00:03:00,578
只要它是一个很好的，独一无二的名字。

63
00:03:00,647 --> 00:03:04,549
像这里一样，我用了edu.stanford.cs193p.emojiart这个名字，

64
00:03:04,617 --> 00:03:08,153
这很可能是一个唯一的类型标识符。

65
00:03:08,222 --> 00:03:09,955
我只需要指定几件事情，

66
00:03:10,023 --> 00:03:11,723
最显着的是在那里的底部，

67
00:03:11,792 --> 00:03:14,592
与表情符艺术一起使用的文件扩展名，

68
00:03:14,661 --> 00:03:19,631
我选了emojiart，.emojiart。然后，一旦你设置好了，

69
00:03:19,699 --> 00:03:22,400
您可以回到顶部的文档类型，

70
00:03:22,469 --> 00:03:25,137
并将其添加为您打开的文档类型。

71
00:03:25,205 --> 00:03:28,706
就这样，是的，我在那里解释了UTI。

72
00:03:28,775 --> 00:03:33,845
现在我们从这堂课的开始就知道，

73
00:03:33,914 --> 00:03:37,082
我们总是选择单视图应用作为我们的应用类型

74
00:03:37,151 --> 00:03:39,617
打开。但实际上，对于基于文档的应用程序，

75
00:03:39,686 --> 00:03:41,452
我们将使用Xcode模板。

76
00:03:41,521 --> 00:03:43,888
它并没有真正给我们太多的模板，

77
00:03:43,957 --> 00:03:46,024
但它足够值得去做。

78
00:03:46,092 --> 00:03:47,959
所以如果你要做一个基于文档的应用程序，

79
00:03:48,028 --> 00:03:52,430
我建议回去创建一个新的应用程序，

80
00:03:52,499 --> 00:03:55,200
一个新项目，将其用作模板。事实上，

81
00:03:55,269 --> 00:03:57,635
我将在演示中做到这一点，即使我们是，你知道，

82
00:03:57,704 --> 00:03:59,037
通过emojiart的80％的方式，

83
00:03:59,106 --> 00:04:00,105
我还是会回去的

84
00:04:00,174 --> 00:04:01,539
用这个创建一个新的emojiart，并且

85
00:04:01,608 --> 00:04:02,707
然后只是移动我的文件。

86
00:04:02,776 --> 00:04:04,809
因为我想要模板附带的东西，而且

87
00:04:04,878 --> 00:04:06,444
让我们来谈谈该模板中的内容。

88
00:04:06,513 --> 00:04:08,647
有一件事是它存根

89
00:04:08,716 --> 00:04:11,883
文档类型，并且它不会执行JSON文件。

90
00:04:11,952 --> 00:04:14,819
它具有图像文件，但您可以将其更改为JSON文件或

91
00:04:14,888 --> 00:04:17,622
添加更多类型。它还会在您的帐户中输入一个条目

92
00:04:17,690 --> 00:04:19,624
Info.plist这非常重要，

93
00:04:19,693 --> 00:04:22,594
称为支持文档浏览器。基本上就是这样

94
00:04:22,663 --> 00:04:25,263
只是说存储在里面的文件

95
00:04:25,332 --> 00:04:28,132
你的应用程序沙盒就像人们想要的真实文档

96
00:04:28,201 --> 00:04:31,403
想打开像文件应用程序或类似的东西。所以

97
00:04:31,472 --> 00:04:33,605
这是放入Info.plist的重要条目，

98
00:04:33,673 --> 00:04:35,574
我们实际上将手动将它放入演示中，

99
00:04:35,642 --> 00:04:37,308
只是为了强调它。

100
00:04:37,377 --> 00:04:39,777
它在AppDelegate中有一个方法，你知道，

101
00:04:39,846 --> 00:04:41,979
AppDelegate的那个文件，我们一直在移出

102
00:04:42,048 --> 00:04:45,417
的方式，成为支持文件。所以它有一种方法

103
00:04:45,485 --> 00:04:48,619
那里允许其他应用程序，如文件应用程序，

104
00:04:48,688 --> 00:04:51,990
要求您的应用程序打开您的文档。这是一个非常

105
00:04:52,058 --> 00:04:54,292
简单的小方法，我们不会去看它

106
00:04:54,361 --> 00:04:57,195
今天，但这个模板确实会为你提供。

107
00:04:57,264 --> 00:04:59,664
它也存储了UIDocument的一个子类

108
00:04:59,733 --> 00:05:02,868
通常不需要，因为你已经创建了自己。

109
00:05:02,936 --> 00:05:05,970
而且它还存储了一个MVC来显示文档，

110
00:05:06,039 --> 00:05:08,740
只是这非常愚蠢的MVC。通常情况下，你并不需要这些，

111
00:05:08,809 --> 00:05:11,609
要么，因为你显然有一个MVC显示你的

112
00:05:11,678 --> 00:05:15,046
文件，或者你不会写这个应用程序。最后，

113
00:05:15,115 --> 00:05:17,882
它给出了UIDocumentBrowserViewControl的子类，

114
00:05:17,951 --> 00:05:19,650
ler，作为自己的代表。

115
00:05:19,719 --> 00:05:22,054
它只有五种方法，非常简单，

116
00:05:22,122 --> 00:05:24,456
我们将详细讨论这些问题。所以

117
00:05:24,525 --> 00:05:26,891
在使用此模板创建项目后，

118
00:05:26,960 --> 00:05:29,094
你需要做什么来让你的应用程序工作？那么，其中一个，

119
00:05:29,162 --> 00:05:31,929
你必须拥有你自己的UIDocument子类

120
00:05:31,998 --> 00:05:36,701
课程。二，你必须拥有自己的文档浏览MVC，

121
00:05:36,769 --> 00:05:38,703
对？像EmojiArtViewController一样，

122
00:05:38,772 --> 00:05:40,872
或者你的ImageGalleryViewController，

123
00:05:40,941 --> 00:05:44,509
无论从你的作业。然后你必须补充

124
00:05:44,577 --> 00:05:48,046
一点点的代码给这个UIDocumentBrowserViewContro-

125
00:05:48,114 --> 00:05:51,282
模板附带的ller子类。在其中

126
00:05:51,351 --> 00:05:53,551
viewDidLoad，你会配置它一点点，

127
00:05:53,620 --> 00:05:55,052
它有几个可以设置的bar，

128
00:05:55,121 --> 00:05:58,289
我们会谈论这个。你也将不得不提供

129
00:05:58,358 --> 00:06:01,493
空白文档的URL。和

130
00:06:01,561 --> 00:06:03,962
这是这样的，当用户进入UI和

131
00:06:04,030 --> 00:06:07,332
说，创建一个新文件，你有，它必须

132
00:06:07,400 --> 00:06:10,902
复制一些模板，文档的一些空白版本，

133
00:06:10,971 --> 00:06:13,705
成为那个新文件。所以你只需要提供URL

134
00:06:13,774 --> 00:06:17,141
的空白文档，以便您支持文档创建。

135
00:06:17,210 --> 00:06:20,544
最后，你必须把代码放在那里，

136
00:06:20,613 --> 00:06:24,182
当有人想要打开你的文件时，你必须

137
00:06:24,251 --> 00:06:28,019
编写代码放入屏幕上的MVC。你不这样做

138
00:06:28,088 --> 00:06:31,122
与继续，所以我们要学习一点点新的方式

139
00:06:31,191 --> 00:06:35,694
在屏幕上放置一个不涉及segues的MVC。和

140
00:06:35,762 --> 00:06:37,528
当然，你想对模板做的最后一件事情，

141
00:06:37,597 --> 00:06:40,498
是更新那些类型，文件类型是，

142
00:06:40,567 --> 00:06:44,235
不会被成像，而是成为JSON或emojiart类型或

143
00:06:44,304 --> 00:06:46,437
图像库类型为您的家庭作业，或任何。所以

144
00:06:46,506 --> 00:06:49,240
一旦你做了这四件事，那些是你做的唯一的四件事

145
00:06:49,308 --> 00:06:52,076
简单的事情，你会得到这个完整的用户界面。所以步骤一

146
00:06:52,145 --> 00:06:55,313
二，你可能已经在你的应用程序中完成了。

147
00:06:55,381 --> 00:06:58,082
第三步看起来像这样，这是viewDidLoad的

148
00:06:58,151 --> 00:07:01,519
UIDocumentBrowser ViewController的子类。

149
00:07:01,588 --> 00:07:04,022
你真的需要第一件事，

150
00:07:04,091 --> 00:07:06,291
这被设置为它自己的代表。

151
00:07:06,360 --> 00:07:09,293
因为它实际上实现了很多这些开放

152
00:07:09,362 --> 00:07:12,463
文件方法和东西使用它自己的委托方法。

153
00:07:12,532 --> 00:07:15,566
那么你可以有一些东西，像allowDocumentCreation =

154
00:07:15,635 --> 00:07:18,403
真正。你是否允许人们在你的应用中创建文档，

155
00:07:18,471 --> 00:07:21,639
或者你只是一个文档查看器？你允许多个吗？

156
00:07:21,708 --> 00:07:23,942
换句话说，用户可以进去

157
00:07:24,010 --> 00:07:27,612
像Shift +单击，或任何等效的东西，

158
00:07:27,681 --> 00:07:30,281
与触摸界面，选择多个项目和

159
00:07:30,350 --> 00:07:32,450
立即打开它们？就像表情艺术不能那样做，

160
00:07:32,519 --> 00:07:34,519
它一次只能显示一个文件。

161
00:07:34,587 --> 00:07:37,589
然后，您还可以稍微调整UI的外观。

162
00:07:37,658 --> 00:07:39,624
改变颜色，色调，

163
00:07:39,693 --> 00:07:42,360
这样的事情，以尝试和你的文件控制器相匹配

164
00:07:42,428 --> 00:07:44,195
当它出现有相同的看起来。

165
00:07:44,263 --> 00:07:46,932
就这样，这就是你在viewDidLoad中配置它的方式，

166
00:07:47,000 --> 00:07:48,933
这主要是您可以设置的设置。

167
00:07:49,001 --> 00:07:52,337
然后你必须提供这个模板的URL，你这样做

168
00:07:52,405 --> 00:07:55,807
以一种奇怪的方式。有这种方法，DocumentBrowser

169
00:07:55,876 --> 00:07:59,077
didRequestDocumentCreationWitHHandler。这就是方法

170
00:07:59,146 --> 00:08:01,779
这就是说，有人想创建一份你的文档

171
00:08:01,848 --> 00:08:05,684
键入您的应用程序。你有什么要给我的是一个URL

172
00:08:05,752 --> 00:08:08,386
到一个模板，到一个空白。它的方式使你

173
00:08:08,455 --> 00:08:11,055
这是否是你手中的一个小功能

174
00:08:11,124 --> 00:08:13,691
importHandler。那里叫它，

175
00:08:13,760 --> 00:08:16,928
我想我称它为Handler来缩短它。

176
00:08:16,997 --> 00:08:19,164
但它实际上被称为importHandler和

177
00:08:19,232 --> 00:08:22,100
它只需要一个URL，它是空白文档的URL。

178
00:08:22,169 --> 00:08:24,969
然后是复制这个或者这个导入模式

179
00:08:25,038 --> 00:08:27,905
移动它以创建一个新文档。所以，这将是移动

180
00:08:27,974 --> 00:08:30,441
如果你每次调用这个东西都创建了这个东西。

181
00:08:30,510 --> 00:08:33,144
这是复制，如果你创建一次，然后你把它

182
00:08:33,213 --> 00:08:35,480
每次有人说新文件时都会出来。

183
00:08:35,548 --> 00:08:37,515
就是这样，你所要做的就是调用这个处理程序，

184
00:08:37,584 --> 00:08:41,585
超级简单，你会在演示中看到。接下来，你必须

185
00:08:41,654 --> 00:08:44,489
展示你的文档MVC，所以我们不得不花一点时间

186
00:08:44,558 --> 00:08:47,024
然后去旁边学习一些不同的东西

187
00:08:47,093 --> 00:08:51,596
这是如何在屏幕上放置MVC而无需继续播放。所以

188
00:08:51,665 --> 00:08:54,633
我们该怎么做？这很容易。有一种方法

189
00:08:54,701 --> 00:08:57,936
在UIViewController中调用了present animated。

190
00:08:58,004 --> 00:09:01,472
如果你是一个ViewController，你可以将它发送给自己

191
00:09:01,541 --> 00:09:04,242
你给它一个另一个MVC的参数，它

192
00:09:04,311 --> 00:09:07,545
呈现动画。它以模态方式呈现在屏幕上，

193
00:09:07,614 --> 00:09:11,082
这意味着它占据了整个屏幕。好的

194
00:09:11,151 --> 00:09:14,418
只是拥有整个屏幕直到它自行解散，

195
00:09:14,487 --> 00:09:17,855
那么它就回到你身上了。这正是我们想要的。

196
00:09:17,924 --> 00:09:23,695
所以，这里的技巧是如何获得一个新的MVC

197
00:09:23,763 --> 00:09:25,413
我早些时候告诉过你，iOS有一些MVC

198
00:09:25,414 --> 00:09:27,064
展示？和

199
00:09:27,133 --> 00:09:29,867
摄像头拍照，拍摄MVC和一些东西。

200
00:09:29,936 --> 00:09:32,537
所以它有一些，但如果你有自己的一个呢？

201
00:09:32,605 --> 00:09:35,039
好的，实际上这很容易。你只是把它放进去

202
00:09:35,108 --> 00:09:38,242
你的故事板，它不会有任何吸引到它，

203
00:09:38,311 --> 00:09:41,412
但你要做的是命名它。你只是要去

204
00:09:41,481 --> 00:09:44,215
选择它，去你的身份检查员，有一点

205
00:09:44,284 --> 00:09:46,250
里面有故事板ID，你给它一个名字和

206
00:09:46,319 --> 00:09:49,754
那么你就像这样在你的代码中使用这个名字。你得到

207
00:09:49,823 --> 00:09:52,323
你说的故事板的一个实例

208
00:09:52,392 --> 00:09:55,926
UIStoryboard名称。你说我们的故事板一直都是

209
00:09:55,995 --> 00:09:58,496
称为Main.storyboard。但我们没有谈到这个事实

210
00:09:58,565 --> 00:10:00,365
你可以拥有多个故事板，

211
00:10:00,433 --> 00:10:04,101
可能合法。我们总是拥有这个主力。和

212
00:10:04,170 --> 00:10:06,571
捆绑几乎是零，因为你有你的主要捆绑，

213
00:10:06,639 --> 00:10:08,306
而零表示你的主要捆绑。所以

214
00:10:08,375 --> 00:10:09,807
你得到故事板，然后你问

215
00:10:09,876 --> 00:10:13,011
故事板让你成为这个名字的MVC

216
00:10:13,080 --> 00:10:15,013
instantiateViewControllerWith- Identifer。

217
00:10:15,082 --> 00:10:17,782
而那个你在那里的富有的就是这个东西

218
00:10:17,851 --> 00:10:20,684
那是在我的MVC身份检查员那里

219
00:10:20,753 --> 00:10:24,389
该MVC的控制器，顶级控制器。和

220
00:10:24,457 --> 00:10:26,691
就是这样，现在你准备好了那个东西。

221
00:10:26,759 --> 00:10:29,561
在这种情况下，通过设置其文档和

222
00:10:29,629 --> 00:10:32,396
那么你只是提出它。所以这真的很简单

223
00:10:32,465 --> 00:10:34,832
instantiateViewControllerWith  - 标识符是关键方法

224
00:10:34,901 --> 00:10:37,235
你需要没有故事板。

225
00:10:37,303 --> 00:10:39,904
好吧，回到我们的现在。所以我们需要能够

226
00:10:39,973 --> 00:10:42,540
编写一个呈现它的函数。这是真的

227
00:10:42,608 --> 00:10:45,076
简单的说，我们只是得到我们的故事板，我们会

228
00:10:45,144 --> 00:10:47,411
从故事板实例化我们的ViewController。

229
00:10:47,480 --> 00:10:50,749
现在，真正重要的是我们要设置文档

230
00:10:50,817 --> 00:10:53,317
显示我们刚刚获得的MVC文档

231
00:10:53,386 --> 00:10:56,488
走出故事板，我们会把它变成一个新的

232
00:10:56,556 --> 00:10:59,757
具有传递给我们的URL的文档，因为它

233
00:10:59,826 --> 00:11:03,260
presentDocument在url。现在这可能是一个新的文件，

234
00:11:03,329 --> 00:11:05,596
它只是通过复制该模板或

235
00:11:05,665 --> 00:11:07,798
这可能是我们打开的一些文档

236
00:11:07,867 --> 00:11:09,801
这是过去创建的。你不知道和

237
00:11:09,870 --> 00:11:13,337
你不在乎这里。然后你只是调用给现在

238
00:11:13,406 --> 00:11:16,340
该文件的MVC。而已，

239
00:11:16,409 --> 00:11:19,177
如果你做到了这一切，那么它只是一切工作。当然，

240
00:11:19,246 --> 00:11:22,313
你想设置你所做的类型，JSON，表情符艺术，

241
00:11:22,382 --> 00:11:25,383
随你。我们将看到所有这些情况

242
00:11:25,452 --> 00:11:28,619
在表情符艺术。所以让我们直接进入演示和

243
00:11:28,688 --> 00:11:32,991
在表情符号艺术中这样做。现在，表情符号艺术是一个明显的应用程序

244
00:11:33,059 --> 00:11:36,494
想要变成基于文档的应用程序。因为

245
00:11:36,562 --> 00:11:39,897
用表情符号来构建这些美丽的艺术作品，对吧？

246
00:11:39,966 --> 00:11:42,533
我们当然可能想要做它们中的多个，而不仅仅是

247
00:11:42,602 --> 00:11:46,404
必须不断地在同一个工作。所以有

248
00:11:46,473 --> 00:11:50,407
关于我们的MVC，我们的EmojiArtViewController。

249
00:11:50,476 --> 00:11:53,944
显示我们的表情符艺术文档的视图控制器。

250
00:11:54,013 --> 00:11:57,415
它没有型号，对吧？我们在这件事上没有模型。

251
00:11:57,483 --> 00:12:01,552
这只是所有的视图。尤其是所有的EmojiArtView。所以

252
00:12:01,621 --> 00:12:04,555
我将在此处添加另一部分

253
00:12:04,624 --> 00:12:07,925
把我的模型。我将把它放在我的模型部分

254
00:12:07,994 --> 00:12:10,528
就在这儿。每个人都记得你所放的这些标记，

255
00:12:10,597 --> 00:12:11,396
导致它如此

256
00:12:11,464 --> 00:12:13,398
当你上到这里时，你可以，

257
00:12:13,466 --> 00:12:15,867
这些就像是在部分。你看到那里的部分？

258
00:12:15,935 --> 00:12:18,202
所以我在这里添加了一个新的模型。和

259
00:12:18,271 --> 00:12:21,839
你可以点击它们跳转到不同的部分。所以

260
00:12:21,907 --> 00:12:24,676
我的模型，它想成为某种变种，我会叫它

261
00:12:24,744 --> 00:12:29,647
emojiArt。这将是一些类型，如EmojiArt。

262
00:12:29,715 --> 00:12:32,650
这种类型不存在，但这就是我的模型

263
00:12:32,718 --> 00:12:37,822
想成为。所以，让我们在这里创建一个结构，或者类或者

264
00:12:37,891 --> 00:12:40,924
结构，表示一个表情符艺术文档。

265
00:12:40,993 --> 00:12:43,194
那么，表情符艺术文件中有什么？

266
00:12:43,263 --> 00:12:45,462
有在后台和URL的URL

267
00:12:45,531 --> 00:12:48,032
那么所有这些表情符号，他们是什么，以及

268
00:12:48,100 --> 00:12:50,034
他们在哪里，他们有多大，对吧？

269
00:12:50,103 --> 00:12:52,771
这是一个表情符艺术文件的样子。所以，

270
00:12:52,839 --> 00:12:55,273
让我们去创建一个模型来做到这一点。

271
00:12:55,342 --> 00:12:57,675
所以我要创建一个新文件，只是一个模型文件。

272
00:12:57,744 --> 00:13:00,144
所以我们在斯威夫特的这里，而不是在Cocoa Touch的这里，

273
00:13:00,213 --> 00:13:03,481
我们在这里用Swift File。我会调用给它

274
00:13:03,550 --> 00:13:07,185
表情符号艺术。完美的感觉称之为。这里是，

275
00:13:07,253 --> 00:13:11,055
我打算快速输入。它是。

276
00:13:11,123 --> 00:13:13,491
所以在这里。完全理解它是什么，

277
00:13:13,560 --> 00:13:17,828
对？ URL，这是背景，然后是一个数组

278
00:13:17,897 --> 00:13:21,532
这些EmojiInfos是这个东西。和每个EmojiInfo

279
00:13:21,600 --> 00:13:25,235
是它的位置，x和y，就像是一辆自行车或者它的文字

280
00:13:25,304 --> 00:13:28,373
蜜蜂，或任何字符串，然后大小，

281
00:13:28,441 --> 00:13:31,142
我将会是字体大小。注意我已经做了

282
00:13:31,210 --> 00:13:33,911
这些Ints而不是CG浮动或其他因为

283
00:13:33,980 --> 00:13:37,081
这是一个模型好吧，这不是一个UI的事情，这是我们的

284
00:13:37,150 --> 00:13:39,984
模型。所以这些可能是Ints，或者他们可能是double的，但是

285
00:13:40,053 --> 00:13:42,754
我决定我想要Ints，因为我希望我的JSON看起来不错

286
00:13:42,822 --> 00:13:45,456
并没有很多分数和

287
00:13:45,525 --> 00:13:47,959
所有这些东西，所以我决定把它们变成Ints。

288
00:13:48,027 --> 00:13:50,528
就这样，这完全代表了表情符号艺术

289
00:13:50,596 --> 00:13:53,131
文件这只是初始化初始化

290
00:13:53,199 --> 00:13:57,534
这两件事。没有别的，只是这个，没事。

291
00:13:57,603 --> 00:14:00,872
现在让我们回想一下我们的EmojiArtViewController

292
00:14:00,940 --> 00:14:04,408
这里。它需要什么才能与之交互

293
00:14:04,477 --> 00:14:08,612
该模型？那么，它需要所有那些小UI标签

294
00:14:08,681 --> 00:14:11,049
在它的EmojiArtView中。没问题。我们可以得到这些。

295
00:14:11,117 --> 00:14:12,916
我们是控制器。我们可以和我们的视图进行交流

296
00:14:12,985 --> 00:14:16,054
从中得到我们想要的任何东西。但它也需要URL和

297
00:14:16,122 --> 00:14:19,257
目前我们实际上并未保留网址

298
00:14:19,325 --> 00:14:20,524
背景图像。

299
00:14:20,593 --> 00:14:22,593
让我们滚动到我们获取该图像的位置，

300
00:14:22,661 --> 00:14:25,897
它在这里的底部。当我们放下一张图片时，

301
00:14:25,965 --> 00:14:28,766
你可以看到我们的图像提取器关闭并提取

302
00:14:28,835 --> 00:14:32,003
该网址和图像。但是，我们只使用图像。

303
00:14:32,071 --> 00:14:35,940
我们不使用网址。所以，我们将开始这样做。

304
00:14:36,008 --> 00:14:37,875
而且我会用一种方式来展示你

305
00:14:37,943 --> 00:14:40,878
有点更多的Swift程序，这是

306
00:14:40,947 --> 00:14:44,515
我要制作这个当前是UIImage的变种，

307
00:14:44,584 --> 00:14:48,185
成为一个元组。为什么我会把它变成一个元组？好，

308
00:14:48,254 --> 00:14:50,421
我要把它变成一个元组，因为我想要URL和

309
00:14:50,490 --> 00:14:53,857
图像始终设置在一起。我永远不会想要

310
00:14:53,926 --> 00:14:56,494
意外设置图像并使URL有所不同。

311
00:14:56,563 --> 00:14:58,763
所以我会一直把它们放在一起。所以我会改变

312
00:14:58,831 --> 00:15:01,032
这从一个UIImage成为一个元组。

313
00:15:01,101 --> 00:15:02,699
那么我们来看看它在哪里宣布，

314
00:15:02,768 --> 00:15:05,669
这里是。它目前是UIImage，

315
00:15:05,738 --> 00:15:09,841
我会改变它是一个具有URL和URL的元组

316
00:15:09,909 --> 00:15:12,743
一个图像作为元组的一部分。而且当然，

317
00:15:12,812 --> 00:15:15,579
改变这种东西的类型会要求我改变它

318
00:15:15,648 --> 00:15:18,949
实施一点点。像所有这些新值一样

319
00:15:19,018 --> 00:15:22,786
这里不再是UIImages了，它们就是这个元组，所以

320
00:15:22,855 --> 00:15:27,224
当我想要图像时，我们必须说newValue.image。和

321
00:15:27,293 --> 00:15:31,428
当我回来时，我不能只是返回图像

322
00:15:31,497 --> 00:15:35,466
在这里，我用一些URL返回元组之后，

323
00:15:35,534 --> 00:15:38,802
UIImage和我要返回的URL。好，

324
00:15:38,871 --> 00:15:40,371
我实际上必须存储它，

325
00:15:40,440 --> 00:15:41,872
所以我会做一个私人变种。

326
00:15:41,941 --> 00:15:46,076
我会调用给emojiArtBackgroundImageURL，

327
00:15:46,145 --> 00:15:50,080
这将是URL。我将把它存储在那里。现在，

328
00:15:50,149 --> 00:15:51,982
我不想从这里设置它，

329
00:15:52,051 --> 00:15:53,351
我会一直想从这里设置它，

330
00:15:53,419 --> 00:15:55,052
但我只是将它用作存储。

331
00:15:55,121 --> 00:15:57,955
有些人可能会在此之前放置一个下方的bar

332
00:15:58,024 --> 00:16:01,692
有点强调，这是背景存储。

333
00:16:01,761 --> 00:16:03,227
我们不会直接设置它。

334
00:16:03,296 --> 00:16:06,530
我们在这里设置网址，所以它始终设置为相同

335
00:16:06,599 --> 00:16:08,066
我也会把它留在bar里。

336
00:16:09,101 --> 00:16:11,368
所以这里的URL就是这个。

337
00:16:11,437 --> 00:16:14,839
所以我只是要返回这个网址。当然，当我设定时，

338
00:16:14,907 --> 00:16:19,343
我需要将网址设置为这个新值网址。可以，然后呢

339
00:16:19,412 --> 00:16:21,511
现在我一直在捕捉URL，

340
00:16:21,580 --> 00:16:25,048
任何时候我都有URL，我有图像。那很好，

341
00:16:25,117 --> 00:16:28,920
我需要它用于我的模型。现在让我们来谈谈这个模型

342
00:16:28,988 --> 00:16:33,424
在这里，我们可以让这个模型像这样存储

343
00:16:33,493 --> 00:16:35,827
然后有一些其他功能，喜欢去和

344
00:16:35,895 --> 00:16:39,763
查看我们的所有UI标签并获取URL和

345
00:16:39,832 --> 00:16:41,666
建立一个emojiArt，但你知道，

346
00:16:41,735 --> 00:16:46,770
我会做一些有趣的事情。看这个，

347
00:16:46,839 --> 00:16:52,910
我会做这个

348
00:16:52,979 --> 00:16:59,083
计算的属性

349
00:16:59,152 --> 00:17:04,488
做一个完美的比赛

350
00:17:04,557 --> 00:17:09,460
与我的用户界面。这真的是

351
00:17:09,529 --> 00:17:11,963
在控制器中拥有的好东西就是模型和

352
00:17:12,031 --> 00:17:15,633
用户界面始终保持同步。所以，这就是为什么我要这样做。

353
00:17:15,702 --> 00:17:18,369
我认为它会在这里很好地工作。好，如此

354
00:17:18,438 --> 00:17:21,772
我需要做什么来获得我的模型？我必须返回网址，

355
00:17:21,841 --> 00:17:25,008
我必须返回所有这些小表情符号的信息，对吧？

356
00:17:25,077 --> 00:17:28,679
我最终不得不返回一些表情符号艺术

357
00:17:28,748 --> 00:17:33,784
调用它的初始化程序，带有一些URL的url和emojis

358
00:17:33,853 --> 00:17:38,455
与一些emojis。所以我们需要创造这两个变量。

359
00:17:38,524 --> 00:17:40,024
那么，这个网址非常简单，

360
00:17:40,093 --> 00:17:43,394
我只是想说如果我让url = my

361
00:17:43,462 --> 00:17:51,802
emojiArtBackgroundImage。这是URL的URL。

362
00:17:51,871 --> 00:17:55,472
如果我能做到这一点，那么我已经准备好返回一些东西

363
00:17:55,541 --> 00:17:58,476
这里。顺便说一句，如果我不能这样做，那么我会回来

364
00:17:58,545 --> 00:18:03,581
无，因为对我而言，我的表情艺术并不是真的

365
00:18:03,649 --> 00:18:07,084
如果它没有背景，那么定义良好。它没有

366
00:18:07,153 --> 00:18:08,652
真的有意义的表情符号艺术，如果有的话

367
00:18:08,721 --> 00:18:10,688
一只蜜蜂和一辆普通的背景上的自行车，

368
00:18:10,756 --> 00:18:13,357
我们并不真的支持这一点。所以我只想说，

369
00:18:13,426 --> 00:18:15,993
如果你问我的模型，我还没有一个URL，

370
00:18:16,062 --> 00:18:18,328
那么我只是说我还没有一个模型。

371
00:18:18,397 --> 00:18:22,299
我没有足够的创造力来说我有一个。所以

372
00:18:22,368 --> 00:18:25,535
修复了URL。这个emojis的东西在这里呢？

373
00:18:25,604 --> 00:18:29,907
我们必须在这里设置这个emojis var，所以我只是想要

374
00:18:29,975 --> 00:18:35,412
说，让emojis =。基本上我想要做的

375
00:18:35,481 --> 00:18:40,584
这里是去问问我的emojiArtView所有的子视图。

376
00:18:40,653 --> 00:18:43,420
但我真的不想要所有这些，我只是想要那些

377
00:18:43,489 --> 00:18:48,425
我可以得到一个UILabel。我在这里使用地图，你

378
00:18:48,494 --> 00:18:52,730
都知道地图。所以这返回到UI标签数组中。

379
00:18:52,798 --> 00:18:56,066
唯一的问题是，这可能会返回零。所以

380
00:18:56,135 --> 00:18:59,202
我实际上想使用称为平面地图的不同地图。

381
00:18:59,271 --> 00:19:02,473
如此平坦的地图就像地图一样，只是如果小功能

382
00:19:02,542 --> 00:19:06,410
返回零它忽略它。所以它没有

383
00:19:06,478 --> 00:19:10,447
没有的，好的。所以现在我拥有所有的UI标签。

384
00:19:10,516 --> 00:19:14,318
现在我需要把它变成这些数组

385
00:19:14,386 --> 00:19:17,154
emojiinfos。好，因为那就是我正在做的事，我是

386
00:19:17,223 --> 00:19:19,823
返回我的模型。那么我该怎么做呢？

387
00:19:19,892 --> 00:19:22,993
我肯定会需要一个采用UI标签的功能

388
00:19:23,062 --> 00:19:25,429
并返回其中一个表情符号。

389
00:19:25,498 --> 00:19:26,497
你知道我要做什么，

390
00:19:26,565 --> 00:19:29,700
我实际上会通过写一个扩展名来做到这一点

391
00:19:29,769 --> 00:19:32,803
对此感到震惊。我会放这个扩展

392
00:19:32,872 --> 00:19:36,340
因为这个扩展名在我的控制器中

393
00:19:36,409 --> 00:19:39,377
将会以UI标签作为参数

394
00:19:39,445 --> 00:19:42,279
作为值返回表情符号信息。

395
00:19:42,347 --> 00:19:45,249
而这个UI标签是一个用户界面的东西，所以不能在我的

396
00:19:45,318 --> 00:19:49,686
模型。但它可以在我的控制器中，并且

397
00:19:49,755 --> 00:19:52,056
这是我的控制器。有些人说，好吧，

398
00:19:52,124 --> 00:19:56,593
等一下。如果你在这里添加一个扩展到EmojiInfo，

399
00:19:56,662 --> 00:19:59,296
你刚刚添加了UI到你的模型。

400
00:19:59,365 --> 00:20:02,666
不，这是我的控制器。不是我的模特，

401
00:20:02,735 --> 00:20:05,769
事实上，我的控制器正在实现这一点

402
00:20:05,838 --> 00:20:08,572
扩展名，这个扩展名就住在我的控制器中

403
00:20:08,640 --> 00:20:11,409
这是完全合法的，你会看到IOS做到这一点

404
00:20:11,477 --> 00:20:14,211
你有什么像NS归因字符串，

405
00:20:14,280 --> 00:20:16,513
我认为这实际上是基础。

406
00:20:16,582 --> 00:20:20,183
但是，当你开始添加像字体等属性

407
00:20:20,252 --> 00:20:22,286
像现在变成UI的东西，

408
00:20:22,354 --> 00:20:25,689
所有这些东西都实现了UI工具包。通过扩展，

409
00:20:25,758 --> 00:20:29,026
在NSAttributeString中。我们在这里做同样的事情。所以

410
00:20:29,094 --> 00:20:30,795
我决定这样做，而不是使用函数，

411
00:20:30,863 --> 00:20:34,164
我实际上添加了一个扩展，添加了一个新的初始化器

412
00:20:34,233 --> 00:20:38,035
到EmojiInfo。用标签初始化它，如果可以的话

413
00:20:38,104 --> 00:20:41,071
从那里获取属性文本并获取它的字体，

414
00:20:41,140 --> 00:20:44,274
那么我可以让自己成为EmojiInfo。如果我不能，

415
00:20:44,343 --> 00:20:48,112
我会返回零，所以这是failable初始值设定项，

416
00:20:48,180 --> 00:20:53,551
这就是你如何从失败的初始化程序中失败。所以，

417
00:20:53,619 --> 00:20:55,152
现在我可以如此轻松地做到这一点，

418
00:20:55,221 --> 00:20:58,289
我只想在这里采用这个UI标签数组

419
00:20:58,357 --> 00:21:02,059
我要平面地图。而我在这里的事情我会

420
00:21:02,128 --> 00:21:06,664
说是返回一个EmojiArt.EmoliInfo

421
00:21:06,733 --> 00:21:11,234
使用我不错的新标签初始值设定项。和

422
00:21:11,303 --> 00:21:17,474
请记住，这里的$ 0就是这些UI标签。你明白了吗？

423
00:21:17,543 --> 00:21:21,044
这有点酷。好的，这是我们的表情符号。

424
00:21:21,113 --> 00:21:25,382
这是创造出EmojiArt，就是这样。这就是我们需要的

425
00:21:25,451 --> 00:21:29,153
做我们的模型。它的设置方面如何？

426
00:21:29,221 --> 00:21:31,522
好吧，当有人设置新的时候，我想要做的第一件事

427
00:21:31,591 --> 00:21:34,658
EmojiArt清楚我已经在那里得到了什么。

428
00:21:34,727 --> 00:21:39,330
所以我会把我的EmojiArt背景图像设置为零，

429
00:21:39,399 --> 00:21:41,031
这是一个元组，记得吗？和

430
00:21:41,099 --> 00:21:44,568
我要设置所有的emojiArtview.subviews，但是

431
00:21:44,637 --> 00:21:47,038
实际上只有那些标签。

432
00:21:50,643 --> 00:21:53,810
我会发一条消息给他们所有的人

433
00:21:53,879 --> 00:21:57,882
每个人从他们的Superview中删除自己。

434
00:22:02,788 --> 00:22:05,122
好的，我只是把所有的标签都放在里面

435
00:22:05,191 --> 00:22:08,458
删除它们是因为有人设置了新模型，所以我是

436
00:22:08,527 --> 00:22:12,663
清理一切。作为问号，我们走了。

437
00:22:14,500 --> 00:22:17,034
所以现在我清除了一切，现在我需要放下

438
00:22:17,103 --> 00:22:19,770
这个新的东西。好吧，为了把网址，

439
00:22:19,839 --> 00:22:23,207
我需要取它。所以让我们取出它，

440
00:22:25,077 --> 00:22:27,444
这里是我如何获取权利，这里是我的形象fetcher，

441
00:22:27,512 --> 00:22:30,548
做同样的事情，当有些事情被抛弃时我做了。

442
00:22:30,616 --> 00:22:33,450
我会在主立方体上做这件事，因为现在我是

443
00:22:33,519 --> 00:22:38,756
当它回来时会用这个URL更新我的用户界面。所以

444
00:22:38,825 --> 00:22:41,392
当这件事回来时我该怎么办？

445
00:22:41,460 --> 00:22:43,693
首先，我要设置我的背景图像。所以

446
00:22:43,762 --> 00:22:48,898
我要设置我的形象，哎呀，我的表情符号艺术

447
00:22:48,967 --> 00:22:53,537
图片背景等于回来的网址和图片，

448
00:22:53,606 --> 00:22:56,206
这又是一个元组。我从这里设置，来

449
00:22:56,275 --> 00:22:59,309
从ImageFetcher返回。现在我需要

450
00:22:59,378 --> 00:23:03,280
为所有表情符号添加所有这些标签，对。蜜蜂和

451
00:23:03,349 --> 00:23:05,182
自行车和我拖下来的一切，

452
00:23:05,250 --> 00:23:08,519
我必须把所有这些都放在那里，所以让我们来做。

453
00:23:08,587 --> 00:23:11,688
可能最简单的方法来做到这一点，有点概念上，

454
00:23:11,757 --> 00:23:14,191
我要把这个表情符号艺术的新价值，

455
00:23:14,259 --> 00:23:16,226
并浏览所有的表情符号。

456
00:23:16,295 --> 00:23:19,630
对于他们每个人，我都想要问我的问题

457
00:23:19,699 --> 00:23:25,669
emojiArtView，添加一个标签

458
00:23:25,737 --> 00:23:29,406
有正确的论点，无论对每一个，对吗？

459
00:23:29,475 --> 00:23:31,842
这在概念上是我想要做的。实际上，

460
00:23:31,911 --> 00:23:34,544
我在表情符号艺术视图中添加了标签，但是我做到了

461
00:23:34,613 --> 00:23:37,280
私人的。所以我要去看我的表情艺术视图并制作

462
00:23:37,349 --> 00:23:42,452
公众。请记住我是那边的管理员。

463
00:23:42,521 --> 00:23:44,988
在我看来，我可以拨打任何我想要的东西。我的视图不能调用

464
00:23:45,057 --> 00:23:47,624
没有盲目的结构沟通，

465
00:23:47,693 --> 00:23:49,126
但我可以调用给我想要的任何东西。

466
00:23:49,195 --> 00:23:50,360
所以在这里，我们有标签和

467
00:23:50,429 --> 00:23:52,195
它看起来像它想要一个属性的字符串和

468
00:23:52,264 --> 00:23:56,132
重点。这很有道理，所以让我们回到这里来

469
00:23:56,201 --> 00:24:02,239
去做。所以，归属文本，

470
00:24:02,307 --> 00:24:07,077
那是他们所谓的吗？我们想要一些归因于，不，

471
00:24:07,146 --> 00:24:12,916
我认为，这只是与归因，

472
00:24:12,985 --> 00:24:17,454
是的。实际上，归因文本和居中，

473
00:24:17,522 --> 00:24:22,425
我已经知道居中了。居中只是一个CG

474
00:24:22,494 --> 00:24:27,831
指出X是这个$ 0.x。

475
00:24:27,900 --> 00:24:32,035
而这是$ 0.y。

476
00:24:32,104 --> 00:24:36,473
因为$ 0是这些表情符号中的每一个，所以它在EmojiInfo中。

477
00:24:36,542 --> 00:24:39,609
EmojiInfo，只是为了提醒你，是这样的，所以

478
00:24:39,678 --> 00:24:43,146
x和y，这是x和y的位置。现在我需要处理

479
00:24:43,215 --> 00:24:46,149
与文本和大小，所以让我们这样做。

480
00:24:46,218 --> 00:24:50,186
我们通过让那个属性文本参数等于做到这一点

481
00:24:50,255 --> 00:24:53,590
文本转换为属性字符串。其实我

482
00:24:53,659 --> 00:24:56,092
有这个很好的小功能，我用公用事业公司写的

483
00:24:56,161 --> 00:24:58,461
归档字符串（withTextStyle）。所以

484
00:24:58,530 --> 00:25:03,133
我要制作一个特定尺寸的体字体，

485
00:25:03,202 --> 00:25:08,004
这是$ 0大小的CGFloat。所以我们已经设定好了

486
00:25:08,073 --> 00:25:11,608
如果现在有人设置我们的模型，繁荣！我们已经设定了一切。

487
00:25:11,677 --> 00:25:14,811
我们的用户界面应该匹配。现在我们状态很好，

488
00:25:14,880 --> 00:25:17,947
因为我们在这里有一个MVC。我们可以有一个模型

489
00:25:18,016 --> 00:25:21,151
设置并获取，使我们的用户界面工作，我们需要做的就是

490
00:25:21,220 --> 00:25:25,322
使其持久。让它存储在磁盘上。我们会

491
00:25:25,391 --> 00:25:28,559
让这个表情符号艺术在这里持续下去

492
00:25:28,627 --> 00:25:31,928
变得可编码，并能够把自己变成一个JSON。

493
00:25:31,997 --> 00:25:35,799
然后我们将使用JSON作为我们的文件格式。所以

494
00:25:35,868 --> 00:25:39,002
让我们回到这里的表情符号艺术，然后

495
00:25:39,070 --> 00:25:41,671
使这件事情生成JSON。和

496
00:25:41,740 --> 00:25:45,475
我们会通过只是说它是Codable来做到这一点。和

497
00:25:45,544 --> 00:25:47,878
当我们把Codable放在那里，然后我们重新编译。

498
00:25:47,947 --> 00:25:50,981
我们要看看这个和这个有什么问题

499
00:25:51,049 --> 00:25:54,151
看它是否可编码。所以我们来了解一下

500
00:25:54,219 --> 00:25:57,554
它说它不是。它说它不能实现可解码

501
00:25:57,623 --> 00:26:00,491
和可编码的，这是这个Codable中的两个协议

502
00:26:00,559 --> 00:26:05,395
协议，为什么不呢？这是可编码的，一个数组是可编码的，

503
00:26:05,464 --> 00:26:09,332
不，这种类型不可编码，好吧，

504
00:26:09,401 --> 00:26:14,204
没问题，冒号，Codable。我们制作了Codable，现在，

505
00:26:14,272 --> 00:26:17,341
我们会让这个东西重新编译，并且错误消失了

506
00:26:17,409 --> 00:26:20,543
看看那个，我们只是把EmojiArt编成了可编辑的。

507
00:26:20,612 --> 00:26:23,346
这就是我告诉你的，这个可编码的东西，

508
00:26:23,415 --> 00:26:25,015
这种新型归档非常简单。

509
00:26:25,084 --> 00:26:27,384
因为你不需要做所有的工作，并解码，

510
00:26:27,453 --> 00:26:31,021
和编码，以及所有这些东西。对于所有结构中的90％

511
00:26:31,090 --> 00:26:33,924
它只会为你做。现在，再次，

512
00:26:33,993 --> 00:26:37,527
我们的JSON密钥将和我们的变量名称一样。

513
00:26:37,596 --> 00:26:39,295
当我们做JSON时，这很好，在这种情况下，

514
00:26:39,364 --> 00:26:40,564
因为他们都很好。但

515
00:26:40,633 --> 00:26:43,367
我们可以通过添加私有枚举编码键来改变它，

516
00:26:43,436 --> 00:26:44,868
冒号字符串，请记住？

517
00:26:44,937 --> 00:26:48,071
所以我，我们不会，但是，但我们可以做到这一点。

518
00:26:48,140 --> 00:26:50,307
好吧，现在，JSON怎么样？

519
00:26:50,375 --> 00:26:53,844
我们如何获得这个JSON版本？好，

520
00:26:53,913 --> 00:26:58,181
我实际上会添加一个变种到这个名为json的EmojiArt。

521
00:26:58,250 --> 00:27:01,351
它返回一个数据，可选，这是可能的，

522
00:27:01,420 --> 00:27:04,888
我想，我们可能无法把自己变成JSON。

523
00:27:04,957 --> 00:27:07,124
但我认为我们会100％，但是

524
00:27:07,192 --> 00:27:11,628
我会让它成为一个数据，只是要清楚。我只是想去

525
00:27:11,697 --> 00:27:16,800
通过返回尝试创建一个JSON

526
00:27:16,869 --> 00:27:23,373
使用JSONEncoder来编码我自己，就是这样。

527
00:27:23,442 --> 00:27:26,343
这要么会返回自己的数据，JSON或

528
00:27:26,411 --> 00:27:28,845
如果它无法做到，现在这是永远不会

529
00:27:28,914 --> 00:27:31,615
失败。我很有信心，这永远不会失败，我甚至可以

530
00:27:31,684 --> 00:27:33,316
在那里尝试感叹号

531
00:27:33,385 --> 00:27:34,485
不要让它成为可选项。

532
00:27:34,553 --> 00:27:39,256
因为这些类型都是100％可编码的。但

533
00:27:39,325 --> 00:27:42,392
我会做这只是为了正确的编程。

534
00:27:42,461 --> 00:27:45,295
所以现在我们有办法把这个东西变成EmojiArt。

535
00:27:45,364 --> 00:27:48,765
所以让我们添加一点点的用户界面到我们的EmojiArt中

536
00:27:48,833 --> 00:27:52,603
我要调用保存一个按钮。你按下保存和

537
00:27:52,672 --> 00:27:55,471
它最终会保存这个JSON，

538
00:27:55,540 --> 00:27:58,175
这个EmojiArt文档以JSON形式作为磁盘。

539
00:27:58,243 --> 00:28:00,276
但首先，我们只需要打印出JSON即可

540
00:28:00,345 --> 00:28:02,512
控制台，所以我们可以看到这里发生了什么。

541
00:28:02,581 --> 00:28:05,749
所以让我们来做吧，让我们转到故事板并添加保存

542
00:28:05,818 --> 00:28:08,151
按钮在这里。现在，如果我们看故事板，看看，

543
00:28:08,219 --> 00:28:10,921
我们在这里有很多垃圾。这是表格视图

544
00:28:10,990 --> 00:28:13,923
我们试图将我们的文档放在表格视图中。

545
00:28:13,992 --> 00:28:16,994
嗯，好吧，我们将在这里进行重大升级，

546
00:28:17,062 --> 00:28:19,729
因为我们要使用那个漂亮的文件应用程序。

547
00:28:19,798 --> 00:28:21,865
所以我只是要删除这个垃圾。

548
00:28:21,933 --> 00:28:26,603
摆脱所有这一切，我想现在把一个保存按钮

549
00:28:26,672 --> 00:28:29,840
在这个用户界面的某处。你知道我会怎么做？

550
00:28:29,909 --> 00:28:32,743
我要把它嵌入导航控制器，所以

551
00:28:32,811 --> 00:28:34,945
我得到顶部的小标题栏，

552
00:28:35,014 --> 00:28:37,681
你会看到这个顶部的小标题栏？

553
00:28:37,749 --> 00:28:40,284
因为这是一个很好的地方，我可以放一点保存按钮

554
00:28:40,352 --> 00:28:43,052
太。所以把东西扔在导航控制器中，

555
00:28:43,121 --> 00:28:45,588
你会得到那个标题栏，这实际上很常见，而且

556
00:28:45,657 --> 00:28:49,492
一个相当不错的功能。所以让我们来这里寻找

557
00:28:49,561 --> 00:28:52,162
bar按钮，bar按钮，在这里。

558
00:28:52,231 --> 00:28:54,764
我们总是在这些栏中使用栏按钮，而不是常规栏

559
00:28:54,833 --> 00:28:57,700
纽扣。我将检查该按钮和

560
00:28:57,769 --> 00:29:00,804
使它成为一个Save，一个名为Save的标准按钮，

561
00:29:00,872 --> 00:29:04,140
它是。让我们把它连接起来，瞄准行动，

562
00:29:04,209 --> 00:29:09,012
进入我们的控制器。所以，控制拖动，在这里，这是

563
00:29:09,080 --> 00:29:13,249
将成为一个行动，我会称之为保存。那是

564
00:29:13,318 --> 00:29:16,252
将成为一个bar按钮项目作为它的论点，我们走了，

565
00:29:16,321 --> 00:29:20,524
这里是。让我们回到全屏幕，让我们可以看到，

566
00:29:20,592 --> 00:29:24,060
哎呀，在这里得到完整的宽度来做我们的保存。

567
00:29:24,129 --> 00:29:28,832
所以这节省下来，我只是想把我的模型打印成JSON

568
00:29:28,901 --> 00:29:33,704
控制台。所以，要做到这一点，我只会说，

569
00:29:33,772 --> 00:29:37,807
如果我可以让json =我的模型，如果我有一个，

570
00:29:37,876 --> 00:29:44,081
这是json。现在我有了json，但它是一个数据。

571
00:29:44,149 --> 00:29:47,217
我想将它打印出来，显然，作为一个字符串。和

572
00:29:47,286 --> 00:29:50,787
当你有一个数据，你想打印它作为一个字符串，

573
00:29:50,856 --> 00:29:54,257
你必须告诉系统编码是什么样的，

574
00:29:54,326 --> 00:29:58,461
它是ASCII码吗？或Unicode，某种Unicode的东西？

575
00:29:58,530 --> 00:30:02,965
那么，JSON总是UTF8，这是Unicode编码，

576
00:30:03,034 --> 00:30:04,634
八位编码。

577
00:30:04,702 --> 00:30:11,141
所以，如果让jsonString = String，我们只要让，

578
00:30:11,210 --> 00:30:15,078
构造函数，采取我拥有的json。

579
00:30:15,146 --> 00:30:18,481
并告诉它什么是编码，这是点，

580
00:30:18,550 --> 00:30:22,252
你可以看到有很多不同种类的isoLatin1

581
00:30:22,321 --> 00:30:26,923
和shiftJIS。而所有这些，ascii就在那里，但是

582
00:30:26,992 --> 00:30:30,393
我们要做utf8。所以如果我们能够做到这一点，

583
00:30:30,462 --> 00:30:34,130
那么我只是要打印它，打印（jsonString）。所以，

584
00:30:34,199 --> 00:30:36,332
现在我们的保存按钮会打印出来，

585
00:30:36,401 --> 00:30:38,202
所以让我们继续并尝试一下。

586
00:30:39,838 --> 00:30:41,537
你会在那里看到一些警告。

587
00:30:41,606 --> 00:30:47,977
那是因为那个，是的，那是警告

588
00:30:48,046 --> 00:30:51,582
一个很好的警告。我们来看看这个警告吧，

589
00:30:51,650 --> 00:30:54,017
它说，我们的故事板不可接触的一部分。

590
00:30:54,085 --> 00:30:58,188
事实上，如果我们在这里看看我们的故事板，

591
00:30:58,257 --> 00:31:01,390
这里是。我们没有切入点的故事板，因为，

592
00:31:01,459 --> 00:31:03,260
请记住，我删除了所有垃圾？

593
00:31:03,328 --> 00:31:06,229
那么，我用它删除了入口点。所以让我们选择

594
00:31:06,297 --> 00:31:09,632
这个导航控制器，并检查它，

595
00:31:09,701 --> 00:31:13,403
并说，这是我们最初的视图控制器。所以你有

596
00:31:13,472 --> 00:31:16,540
注意你的警告在这里，对吗？

597
00:31:16,608 --> 00:31:19,809
所以让我们把我们的控制台备份起来，

598
00:31:19,878 --> 00:31:24,014
尽可能宽，跑，回去

599
00:31:24,083 --> 00:31:26,883
看看这里。好的，这次它正在运行。

600
00:31:26,952 --> 00:31:29,753
所以这里是我们的EmojiArt，让我们继续前进

601
00:31:29,821 --> 00:31:33,090
制作一个不错的EmojiArt文档。这件事怎么样

602
00:31:33,158 --> 00:31:36,893
在这里，让我们在路上放一辆小自行车，

603
00:31:36,962 --> 00:31:39,796
在那里。现在我要打保存了

604
00:31:39,865 --> 00:31:43,866
让我们在那边看我们的控制台。哎呀，保存，看，

605
00:31:43,935 --> 00:31:48,004
它是。这是我们的表情符号，它有网址，

606
00:31:48,073 --> 00:31:51,808
这是真的很长的谷歌图像表情符号。

607
00:31:51,877 --> 00:31:53,376
然后它有了emojis，

608
00:31:53,445 --> 00:31:56,479
这是一个阵列，只有一件事，就是自行车。

609
00:31:56,548 --> 00:31:59,982
所以让我们再添加一件事，我最喜欢的第二件事是添加，

610
00:32:00,051 --> 00:32:04,087
这是一只蜜蜂，并保存。现在JSON有蜜蜂在里面

611
00:32:04,156 --> 00:32:07,824
好。所以这里工作很少，

612
00:32:07,893 --> 00:32:11,060
只要让这个东西可以编码，我们已经做到了

613
00:32:11,129 --> 00:32:14,197
我们可以将文档保存为JSON格式。所以

614
00:32:14,266 --> 00:32:16,900
现在让我们添加文件系统代码来实际写出它

615
00:32:16,969 --> 00:32:19,236
到磁盘。这就是我们下一步的工作，所以

616
00:32:19,304 --> 00:32:23,206
让我们去做那个。回到我们的控制器这里。

617
00:32:23,275 --> 00:32:25,542
所以不是把它作为JSON打印出来，

618
00:32:25,611 --> 00:32:27,543
我们只是将它写入磁盘。

619
00:32:27,612 --> 00:32:32,315
现在这是类型数据，对吧？这是一个数据。所以

620
00:32:32,384 --> 00:32:39,022
我可以用json.write [to：url]将它写入磁盘。

621
00:32:39,091 --> 00:32:41,625
现在，有几件事情，我们必须说明我们的网址

622
00:32:41,693 --> 00:32:43,659
会写给它。当然这会抛出。

623
00:32:43,728 --> 00:32:46,696
所以你必须做这两件事。第一，

624
00:32:46,764 --> 00:32:49,332
让我们来谈谈我们要写给它的网址。好，

625
00:32:49,401 --> 00:32:51,968
无论何时你谈论文件系统，数字是多少

626
00:32:52,036 --> 00:32:54,404
你创建网址时必须做的一件事是什么？

627
00:32:54,473 --> 00:32:57,273
在沙箱中查找一个目录以开始。

628
00:32:57,342 --> 00:32:59,675
总是这样做。一次100.0％，你会去的

629
00:32:59,744 --> 00:33:01,878
将某些内容写入文件系统或从中读取某些内容

630
00:33:01,946 --> 00:33:04,514
文件系统。你必须弄清楚哪个沙箱

631
00:33:04,583 --> 00:33:08,117
目录你要开始。所以这是一个文件，所以

632
00:33:08,186 --> 00:33:11,688
我将把它放在我的文档目录中。所以我，

633
00:33:11,757 --> 00:33:16,292
让我们在这里输入。这是我们如何查找沙盒

634
00:33:16,361 --> 00:33:20,363
目录，这是默认的FileManager.default方法

635
00:33:20,431 --> 00:33:22,465
网址。所以我们正在寻找文档目录。

636
00:33:22,534 --> 00:33:25,301
我们总是做userDomainMask。我们并没有更换文件

637
00:33:25,370 --> 00:33:27,337
我们不关心这一点。我们想创造

638
00:33:27,405 --> 00:33:30,340
文档目录如果没有。然后我会去的

639
00:33:30,408 --> 00:33:33,176
将我的文件的名称附加到文档的该URL

640
00:33:33,245 --> 00:33:37,614
目录。 untitled.json，我会调用给它。所以

641
00:33:37,682 --> 00:33:40,683
现在我有了网址。我可以把它放在这里写下来。

642
00:33:40,752 --> 00:33:43,353
现在我只需要处理这个问题。

643
00:33:43,421 --> 00:33:47,357
所以这意味着我必须把它放在前面。和

644
00:33:47,425 --> 00:33:50,494
实际上我会在这里发现错误。

645
00:33:52,931 --> 00:33:58,035
抓住，哎呀，抓住让错误。如果我得到一个错误，我在这里

646
00:33:58,103 --> 00:34:01,771
会说打印（“不能”），哎呀，不能。

647
00:34:01,840 --> 00:34:04,774
保存，我们会把错误放在那里，所以

648
00:34:04,843 --> 00:34:07,443
我们可以看到它是什么。但是，如果不失败，

649
00:34:07,512 --> 00:34:10,881
那么我会说保存成功。

650
00:34:13,685 --> 00:34:16,352
所以，现在当我们在我们的控制台上运行时，我们应该看到，

651
00:34:16,421 --> 00:34:19,222
要么保存成功，要么保存不了。

652
00:34:19,291 --> 00:34:23,426
所以，我们来试试这个。把所有的代码放在这里一样

653
00:34:23,495 --> 00:34:28,431
所以你可以看到它。再次运行。我们出去吧

654
00:34:28,500 --> 00:34:35,805
看到了。所以关于我们的应用程序的一件事，当然，

655
00:34:35,874 --> 00:34:38,708
每次启动时，我们都不加载文档。

656
00:34:38,776 --> 00:34:39,609
所以，它总是空白。

657
00:34:39,677 --> 00:34:42,378
所以我们将永远不得不重新开始。所以，我们开始吧

658
00:34:42,447 --> 00:34:47,150
再次与这一个。让我们在这里把一个苹果放在天空中。

659
00:34:47,219 --> 00:34:50,020
我现在会保存并希望它会保存

660
00:34:50,088 --> 00:34:52,956
成功地在我们的控制台，准备好呜呼，

661
00:34:53,024 --> 00:34:57,193
保存成功！我们再添加一杯咖啡。

662
00:34:57,262 --> 00:35:00,196
成功保存，它正在工作。但是，这不是很好

663
00:35:00,264 --> 00:35:02,966
令人满意，因为它只是说保存成功。

664
00:35:03,034 --> 00:35:06,102
你就是这样，是的，当然，好吧，你说它已经保存了。但

665
00:35:06,171 --> 00:35:08,471
它真的保存了吗？但实际上，我们可以去看看

666
00:35:08,539 --> 00:35:11,174
看看它是否保存并去找这个文件。因为

667
00:35:11,243 --> 00:35:15,178
我们有iOS 11文件应用程序，让我们看看

668
00:35:15,246 --> 00:35:18,381
选择加入的应用程序中的文档。现在，

669
00:35:18,450 --> 00:35:21,684
关键是有选择的应用程序。所以我们必须真正放入

670
00:35:21,753 --> 00:35:24,754
那个小的info.plist的东西我说的是我们说的

671
00:35:24,823 --> 00:35:27,590
是一个应用程序，你可以在我们的文档目录和

672
00:35:27,659 --> 00:35:29,325
看我们的文件。所以我们去做吧。

673
00:35:29,394 --> 00:35:32,528
我们只是在这里跳转到我们的info.plist。我会去的

674
00:35:32,597 --> 00:35:35,698
做同样的事情，我们在你的家庭作业中做的

675
00:35:35,767 --> 00:35:39,569
您添加了一行，请记住，要执行HTTP URL。所以

676
00:35:39,638 --> 00:35:45,341
我要添加一行，支持文档浏览器，

677
00:35:45,410 --> 00:35:47,110
它是。支持文档浏览器和

678
00:35:47,179 --> 00:35:51,581
我会把它设置为是。那告诉系统，好吧，

679
00:35:51,650 --> 00:35:53,416
你可以看看我的文档目录和

680
00:35:53,485 --> 00:35:56,419
看我的文件。所以我必须再次跑步，因为我们必须这样做

681
00:35:56,488 --> 00:35:59,789
将应用程序转移回iPad，所以

682
00:35:59,857 --> 00:36:02,525
它会在这里查看这个info.plist。但实际上，

683
00:36:02,594 --> 00:36:04,727
我甚至不需要再次创建无标题的JSON，

684
00:36:04,796 --> 00:36:07,697
它已经在那里了。所以我从底部滑过来

685
00:36:07,765 --> 00:36:09,432
让这个小东西出现在这里的底部。

686
00:36:09,500 --> 00:36:10,800
我要点击或

687
00:36:10,869 --> 00:36:13,302
在这里触摸这个应用程序。这是文件应用程序。

688
00:36:13,371 --> 00:36:16,539
你会在这里看到用户界面的文件。

689
00:36:16,608 --> 00:36:20,009
这是你的UI在你的应用中看起来很多的东西。

690
00:36:20,078 --> 00:36:22,212
所以这里有所有这些漂亮的文件夹。

691
00:36:22,280 --> 00:36:24,814
你可以按日期，标签和

692
00:36:24,883 --> 00:36:27,817
名称。你可以把东西放在你的iCloud Drive上。你可以放

693
00:36:27,886 --> 00:36:31,354
iPad上的东西。在这里，我点击iPad。表情符号艺术

694
00:36:31,422 --> 00:36:34,257
是唯一的应用程序在我的iPad上目前有一个文件

695
00:36:34,326 --> 00:36:38,160
目录，允许查看文件。

696
00:36:38,229 --> 00:36:41,163
这是因为这款iPad的安装非常新颖。

697
00:36:41,232 --> 00:36:44,000
但在这里，我的应用程序。如果我点击这个通知它放

698
00:36:44,069 --> 00:36:46,903
我的应用程序图标，这有点不错。如果我点击它，

699
00:36:46,971 --> 00:36:50,173
呜呼，它是untitled.json。我可以长时间按下它，

700
00:36:50,242 --> 00:36:53,375
并说信息。它甚至会告诉我看，这是那种

701
00:36:53,444 --> 00:36:56,612
文件，它是一个* .json文件。它有656个字节，这听起来

702
00:36:56,681 --> 00:37:00,182
差不多。这是关于我们在那里有多少事情。

703
00:37:00,251 --> 00:37:02,885
我甚至可以点击它来查看它。然而，

704
00:37:02,954 --> 00:37:08,057
看它在哪里看它。在某种JSON中，

705
00:37:08,126 --> 00:37:11,093
查看某种应用程序。

706
00:37:11,162 --> 00:37:14,364
不在我们的应用程序，所以这有点奇怪。

707
00:37:14,432 --> 00:37:17,733
这是为什么？那么，因为我们不是JSON查看应用程序，

708
00:37:17,802 --> 00:37:20,770
我们是一个表情符号艺术应用程序。所以文件应用程序不

709
00:37:20,839 --> 00:37:23,306
知道我们是在那里开放的人。我们可以修复

710
00:37:23,375 --> 00:37:25,875
稍后一点。我们可能不会有时间

711
00:37:25,944 --> 00:37:27,176
今天用演示来完成它。

712
00:37:27,245 --> 00:37:29,679
但是我肯定会在我发布并展示给你的代码中做到这一点。

713
00:37:29,747 --> 00:37:32,882
解决方法是定义一个名为的新文件类型

714
00:37:32,950 --> 00:37:35,651
表情艺术。然后文件应用程序将知道，

715
00:37:35,720 --> 00:37:37,053
这是一个表情符号艺术的东西。

716
00:37:37,121 --> 00:37:39,389
但现在，它看起来延伸json并说，

717
00:37:39,458 --> 00:37:41,524
我会做json的事情。

718
00:37:41,593 --> 00:37:42,926
而且你可以告诉，但看到它是正确的。

719
00:37:42,994 --> 00:37:44,927
它有苹果，它里面有咖啡。

720
00:37:44,996 --> 00:37:48,531
它非常小，但你可以看到它。所以，这很好。所以，

721
00:37:48,600 --> 00:37:50,867
我们知道它实际上是储蓄。所以让我们继续下一步，

722
00:37:50,935 --> 00:37:52,969
这是阅读这份文件。所以，

723
00:37:53,038 --> 00:37:56,305
让我们有我们的应用程序，每次它把它的视图控制器

724
00:37:56,374 --> 00:37:59,509
看起来会出现，我们会做，它会寻找

725
00:37:59,578 --> 00:38:02,211
untitled.json，并加载它。

726
00:38:02,280 --> 00:38:04,747
这样，每次我们运行我们的应用程序，它都不会是空白的

727
00:38:04,816 --> 00:38:07,517
每次。它只会载入我们最后的文件

728
00:38:07,586 --> 00:38:10,620
在我们正在开发的untitled.json上工作。可以，然后呢

729
00:38:10,689 --> 00:38:16,292
让我们这样做。回到我们的控制器。

730
00:38:16,360 --> 00:38:20,763
这里是我们的视图控制器。所以我们会做的

731
00:38:20,832 --> 00:38:26,869
那在看来会出现。 super.viewWillAppear（animat-

732
00:38:26,938 --> 00:38:31,674
ED）。那么，我们在这里需要做些什么呢？

733
00:38:31,742 --> 00:38:33,943
让这个出现？这非常简单。

734
00:38:34,012 --> 00:38:38,314
我们只需要获取untitled.json的URL。和

735
00:38:38,383 --> 00:38:42,185
然后查看数据并将其重新转换为表情符艺术和

736
00:38:42,253 --> 00:38:43,752
将其设置为我们的模型。

737
00:38:43,821 --> 00:38:47,323
明白了，让我们这样做。当然我需要那个URL。

738
00:38:47,392 --> 00:38:50,994
所以我会做和以前一样的事情。

739
00:38:51,063 --> 00:38:54,030
我叫什么，让网址，是的。所以

740
00:38:54,099 --> 00:38:56,633
这里是我去我的文档目录和

741
00:38:56,701 --> 00:38:59,268
追加untitled.json上的路径组件。

742
00:38:59,337 --> 00:39:02,605
这正是我在这里所做的，没有别的因素我想要

743
00:39:02,674 --> 00:39:07,677
完全相同的网址。但在这里，我要说如果我可以放过

744
00:39:07,746 --> 00:39:12,515
jsonData等于试图让数据contentsOf，

745
00:39:12,584 --> 00:39:16,986
完全一样的东西。这个数据contentsOf正是

746
00:39:17,055 --> 00:39:20,356
我们做了什么来通过HTTP获取图像url，对吗？

747
00:39:20,425 --> 00:39:23,793
所以，文件url的内容，这是

748
00:39:23,861 --> 00:39:26,729
这个未命名的json文件在我们的文档目录中。

749
00:39:26,798 --> 00:39:30,399
这就是这个网址。所以如果我能够创建数据

750
00:39:30,468 --> 00:39:33,937
那个文件，现在我需要创建一个emojiArt，

751
00:39:34,005 --> 00:39:38,073
并将其设置为我的模型。所以emojiArt是我的典范，

752
00:39:38,142 --> 00:39:42,811
让我说等于。我需要从中创建EmojiArt

753
00:39:42,880 --> 00:39:47,950
一些jsonData。那么，我们没有一个初始化器

754
00:39:48,019 --> 00:39:51,721
EmojiArt从jsonData创建EmojiArt。

755
00:39:51,790 --> 00:39:53,823
但我们可以很容易地写出一个。

756
00:39:53,892 --> 00:39:55,992
让我们回到这里的表情符号艺术。

757
00:39:56,060 --> 00:39:58,327
就像我们写这个获得JSON一样，

758
00:39:58,396 --> 00:40:00,629
我们当然可以写一个初始化器，

759
00:40:00,698 --> 00:40:02,698
我也会失败的，

760
00:40:02,767 --> 00:40:07,336
这需要一些JSON，这是一个数据。并且，初始化，

761
00:40:07,405 --> 00:40:10,807
如果我无法初始化它，那么我将失败并且

762
00:40:10,875 --> 00:40:14,811
返回零。那么它看起来像做什么？再次，

763
00:40:14,879 --> 00:40:18,447
真的很简单。我只是想说，如果我可以让新的价值，

764
00:40:18,516 --> 00:40:21,183
这将成为我从中拉出的新价值，

765
00:40:21,252 --> 00:40:28,190
平等尝试JSONDecoder。

766
00:40:28,259 --> 00:40:30,493
我想从数据中解码出什么？

767
00:40:30,562 --> 00:40:34,730
我正在尝试解码EmojiArt对象。

768
00:40:34,799 --> 00:40:38,200
并从什么数据？您通过的JSON。

769
00:40:38,269 --> 00:40:39,435
所以如果我能够做到这一点，

770
00:40:39,504 --> 00:40:42,871
如果我能够解码它，现在我拥有了它。

771
00:40:42,940 --> 00:40:45,642
新价值的新事物，所以我只想说，

772
00:40:45,710 --> 00:40:49,044
self = newValue，对吗？我的意思是，这里是一个初始化器。所以，

773
00:40:49,113 --> 00:40:51,581
我只是要初始化自己，而我会失败

774
00:40:51,650 --> 00:40:54,917
否则返回零。现在，这更多

775
00:40:54,986 --> 00:40:58,554
可能会失败，因为你可以想象损坏的JSON，

776
00:40:58,623 --> 00:41:02,324
只是播放错误的JSON文件。一个空的JSON文件，全部

777
00:41:02,393 --> 00:41:04,360
这些事情会导致失败，这很好。

778
00:41:04,429 --> 00:41:05,761
只是这不会初始化，

779
00:41:05,830 --> 00:41:10,166
这只是要初始化。如果这对JSON有效

780
00:41:10,235 --> 00:41:13,969
编码，从这基本上这是唯一的方法

781
00:41:14,038 --> 00:41:18,474
它会成功。所以现在我们的代码会在这里工作，

782
00:41:18,543 --> 00:41:21,277
对？我们已经实施了，所以

783
00:41:21,346 --> 00:41:25,414
现在，当我们退出并返回时，我们的文档应该在那里。

784
00:41:25,483 --> 00:41:29,152
让我们这样做，让我们运行和

785
00:41:29,220 --> 00:41:33,456
然后展示给你。这是和

786
00:41:33,525 --> 00:41:37,226
肯定看看，它已经拿起了

787
00:41:37,295 --> 00:41:41,730
untitled.json，如果我添加一个狗，并点击保存。

788
00:41:41,799 --> 00:41:47,369
然后退出并再次运行，

789
00:41:47,438 --> 00:41:50,773
带着狗回来。所以我们都挽救了它，

790
00:41:50,841 --> 00:41:53,109
与保存按钮，并会出现视图，

791
00:41:53,177 --> 00:41:55,612
我们正在加载它。所以这很好。

792
00:41:55,680 --> 00:41:57,847
我们在这里取得了很大的进展。

793
00:41:57,915 --> 00:42:00,450
但现在是时候把它提升到一个新的水平，

794
00:42:00,518 --> 00:42:03,552
这是能够做到这一点的文件应用程序的用户界面。和

795
00:42:03,621 --> 00:42:07,423
做到这一点，简化这一过程，并简化我们现有的工作

796
00:42:07,492 --> 00:42:11,694
代码实际上，我们需要使用UIDocument。 UIDocument

797
00:42:11,763 --> 00:42:14,930
在这真正美丽的封装一个文件

798
00:42:14,999 --> 00:42:17,900
方式，非常好的API。这就是我们需要做的。

799
00:42:17,969 --> 00:42:19,402
现在我们可以在这里做到这一点。

800
00:42:19,470 --> 00:42:22,204
你所要做的就是创建一个UIDocument子类，

801
00:42:22,273 --> 00:42:25,174
并实施我在讲座中谈到的两种方法

802
00:42:25,243 --> 00:42:27,176
星期一。但是，我们要介入的地方

803
00:42:27,245 --> 00:42:30,146
使用该模板。我们要把这个模板放在这里

804
00:42:30,214 --> 00:42:36,319
为文件库。所以我会在这里停止我的应用程序。

805
00:42:38,456 --> 00:42:41,390
我要重命名我现有的表情符号艺术。

806
00:42:41,459 --> 00:42:45,094
我只是将它称为EmojiArtOLD。然后我是

807
00:42:45,162 --> 00:42:49,031
会回到Xcode并创建一个新项目。在这上面

808
00:42:49,100 --> 00:42:51,767
两个项目我会在这里使用这个基于文档的应用程序。

809
00:42:51,836 --> 00:42:53,836
我想要称之为EmojiArt，

810
00:42:53,905 --> 00:42:56,705
基本上这将是同样的应用程序会有

811
00:42:56,774 --> 00:43:00,243
这个建立在这个模板上。我会把同一个地方，

812
00:43:00,311 --> 00:43:02,545
我把所有的东西都放在这里。

813
00:43:02,614 --> 00:43:06,048
让我们快速看看这些东西。

814
00:43:06,117 --> 00:43:09,184
这只是一种普通的Xcode应用程序，当然，

815
00:43:09,253 --> 00:43:12,422
它具有资产，启动屏幕和应用程序代理。

816
00:43:12,490 --> 00:43:15,958
所以我会把这三件事情放在一点

817
00:43:16,027 --> 00:43:20,729
支持文件就像我一直这样做。但是，我会

818
00:43:20,798 --> 00:43:25,701
花点时间先看看AppDelegate。

819
00:43:25,770 --> 00:43:28,203
因为AppDelegate不仅仅是一堆

820
00:43:28,272 --> 00:43:30,573
只有注释的空方法，

821
00:43:30,642 --> 00:43:32,975
它现在也有这个实际的方法。

822
00:43:33,044 --> 00:43:36,579
这种方法称为open inputURL。这是发送

823
00:43:36,648 --> 00:43:38,847
由其他应用程序将您的应用程序

824
00:43:38,916 --> 00:43:42,618
喜欢的文件，说，我想打开你的文件之一。

825
00:43:42,687 --> 00:43:45,154
现在，如果我们有表情符号艺术，这只会被调用

826
00:43:45,223 --> 00:43:47,556
文档，而不是JSON文档，因为我们不是，

827
00:43:47,625 --> 00:43:50,326
JSON开放应用程序。但是，这是如何发生的。

828
00:43:50,394 --> 00:43:52,661
这是非常简单的代码，我不会通过它，但是

829
00:43:52,730 --> 00:43:55,231
这是发生的地方。我们要谈谈所有关于

830
00:43:55,299 --> 00:43:59,034
AppDelegate，所有这些东西，下周好了。

831
00:43:59,103 --> 00:44:01,236
所以我们得到了支持文件。那里还有什么？

832
00:44:01,305 --> 00:44:03,940
那么，我们有这个UIDocument子类

833
00:44:04,008 --> 00:44:05,608
称为文档。好，

834
00:44:05,677 --> 00:44:10,479
这将最终成为我们的EmojiArtDocument。

835
00:44:10,548 --> 00:44:14,883
EmojiArt，所以你可以重命名文件的名字

836
00:44:14,952 --> 00:44:19,488
EmojiArt。所以这有两个功能，对吧？

837
00:44:19,557 --> 00:44:21,691
从模型转换为数据的模型，

838
00:44:21,759 --> 00:44:23,493
并从数据到模型，来回。

839
00:44:23,561 --> 00:44:25,861
这就是我们必须执行的工作。

840
00:44:25,930 --> 00:44:27,396
所以我们会稍微做一点。

841
00:44:27,465 --> 00:44:30,132
然后是这个，DocumentViewController，

842
00:44:30,201 --> 00:44:33,135
基本上就像EmojiArtViewController，对吧？

843
00:44:33,204 --> 00:44:36,072
它只是DocumentViewController的存根。

844
00:44:36,140 --> 00:44:38,040
当然，我们有EmojiArtViewController

845
00:44:38,109 --> 00:44:38,741
我们不需要这个。

846
00:44:38,809 --> 00:44:41,911
所以我只是要右键点击它

847
00:44:41,980 --> 00:44:44,413
删除它。所以我要删除这个DocumentViewController。

848
00:44:44,482 --> 00:44:47,750
我不需要它，我有我的EmojiArtViewController。和

849
00:44:47,819 --> 00:44:50,218
那么这是DocumentBrowserViewController

850
00:44:50,287 --> 00:44:53,188
就在这里。这是子类

851
00:44:53,257 --> 00:44:56,358
UIDocumentBrowserViewController。这是viewDidLoad I

852
00:44:56,427 --> 00:44:58,928
告诉你我们要配置它。这是这个地方

853
00:44:58,996 --> 00:45:02,264
我们将调用该导入处理程序进行复制

854
00:45:02,333 --> 00:45:05,100
一个模板。以下是我们甚至没有的其他方法

855
00:45:05,169 --> 00:45:05,902
将不得不碰，

856
00:45:05,970 --> 00:45:08,070
他们只是在打开时才会调用

857
00:45:08,139 --> 00:45:10,639
一个文件。然后这里有这个

858
00:45:10,708 --> 00:45:13,308
presentDocument，我将删除大部分内容。

859
00:45:13,377 --> 00:45:15,912
这只是一个全部调用的内部方法

860
00:45:15,980 --> 00:45:19,916
那些说的其他东西，为此呈现您的MVC

861
00:45:19,984 --> 00:45:24,320
文档在这个URL。所以我们很快就会实施。

862
00:45:24,389 --> 00:45:26,021
然后，当然，我们有了我们的故事板。

863
00:45:26,090 --> 00:45:27,222
让我们看看我们的故事板中有什么。

864
00:45:27,291 --> 00:45:31,127
我要让我们的故事板看起来更像iPad。

865
00:45:31,195 --> 00:45:33,963
这对我们来说更加熟悉。虽然，

866
00:45:34,032 --> 00:45:35,898
顺便说一下，我们的应用程序将在iPhone上工作。

867
00:45:35,967 --> 00:45:38,433
毕竟，我会告诉你，希望，

868
00:45:38,502 --> 00:45:41,537
如果我们有时间的话。所以只有两个视图控制器

869
00:45:41,606 --> 00:45:44,607
在这个故事板上，这是一个。

870
00:45:44,676 --> 00:45:46,642
这是DocumentBrowserViewController。

871
00:45:46,711 --> 00:45:50,212
这是看起来像文件应用程序的东西。和

872
00:45:50,281 --> 00:45:53,182
注意这是我们进来的地方。

873
00:45:53,251 --> 00:45:56,084
我们到达这个应用程序。然后是这个，

874
00:45:56,153 --> 00:45:58,888
这将是我们的EmojiArtViewController。

875
00:45:58,956 --> 00:46:01,156
事实上，我要删除这里出现的那个，

876
00:46:01,225 --> 00:46:02,424
因为它只是一个小小的占位符。

877
00:46:02,493 --> 00:46:05,227
我要把我的EmojiArtViewController放在这里，

878
00:46:05,296 --> 00:46:06,662
让我们马上去做吧。

879
00:46:06,731 --> 00:46:10,899
事实上，我会在这里回到EmojiArt.old。

880
00:46:10,968 --> 00:46:12,801
我要去看故事板。

881
00:46:12,870 --> 00:46:15,938
有一件事情对于故事板来说真的很酷

882
00:46:16,007 --> 00:46:18,841
您可以从一个故事板复制并粘贴到另一个故事板，

883
00:46:18,910 --> 00:46:22,278
因为所有的代码连接都是通过名字来完成的。

884
00:46:22,347 --> 00:46:23,579
这只是名字，所以

885
00:46:23,648 --> 00:46:25,548
只要名称在两个方面都是相同的，

886
00:46:25,616 --> 00:46:28,584
它的作品。所以我只是要选择所有这些和

887
00:46:28,652 --> 00:46:33,155
打副本。然后回到我的新的这里和

888
00:46:33,224 --> 00:46:37,292
点击粘贴。缩小一点，所以我可以看到这一切。

889
00:46:37,361 --> 00:46:43,198
转到我们的文档大纲，在这里看起来不错。

890
00:46:43,267 --> 00:46:44,166
现在有一件事要注意，

891
00:46:44,235 --> 00:46:46,334
我知道在这个屏幕上有点难以看到，所以

892
00:46:46,403 --> 00:46:47,369
我会尽量放大。

893
00:46:47,438 --> 00:46:50,305
但是你注意到这里没有连线，对吧？

894
00:46:50,374 --> 00:46:53,275
这些靠自己生活，这个靠自己生活。和

895
00:46:53,344 --> 00:46:56,278
这就是为什么我们必须做这个手册介绍。另一个

896
00:46:56,347 --> 00:46:58,814
我现在要做的事情是我会有切入点

897
00:46:58,882 --> 00:47:01,883
做我们现有的视图控制器。我们将添加这一个

898
00:47:01,952 --> 00:47:04,586
一旦我们得到UIDocument的东西工作，因为我们必须

899
00:47:04,655 --> 00:47:08,123
在我们真正能够利用这个之前，先有UIDocument工作。

900
00:47:08,192 --> 00:47:10,092
所以我们现在只需要使用旧的用户界面。

901
00:47:10,160 --> 00:47:12,828
而且我会尝试让我们现有的应用程序像我们一样

902
00:47:12,897 --> 00:47:14,663
在使用UIDocument之前。

903
00:47:14,732 --> 00:47:16,265
所以它会是完全一样的东西，但是

904
00:47:16,334 --> 00:47:18,567
只需使用UIDocument而不是直接访问

905
00:47:18,635 --> 00:47:22,304
那里的文件系统。所以我们当然也需要拥有

906
00:47:22,373 --> 00:47:25,207
我们所有的旧文件。所以让我们回到过去

907
00:47:25,276 --> 00:47:30,378
EmojiArt在这里。把所有的东西都拿出来，哎呀！

908
00:47:30,447 --> 00:47:33,916
这样，在屏幕上同时获得这两样东西

909
00:47:33,984 --> 00:47:36,651
在这个非常小的屏幕上可以是一个挑战，没关系。

910
00:47:36,720 --> 00:47:42,658
所以我要让我的控制器，我的模型，我的视图。

911
00:47:42,726 --> 00:47:45,595
一些支持文件像单元格，

912
00:47:45,663 --> 00:47:48,964
手势识别器的东西。公用事业，

913
00:47:49,033 --> 00:47:52,368
我做的东西，我没有带过AppDelegate，

914
00:47:52,436 --> 00:47:56,271
因为这是随模板一起提供的。所以我不想做

915
00:47:56,340 --> 00:47:59,374
这一点，我也没有带过我的TableViewController。

916
00:47:59,443 --> 00:48:01,644
这就是垃圾，这就是TableViewController

917
00:48:01,713 --> 00:48:03,145
这被认为是文件的东西，但是

918
00:48:03,213 --> 00:48:05,614
我们说忘记了，我们正在使用这个新文件的东西

919
00:48:05,682 --> 00:48:10,185
我只是想把这些拖到这里。将它们全部复制并

920
00:48:10,254 --> 00:48:13,688
我想从这里带来的另一件事是我的

921
00:48:13,757 --> 00:48:17,560
应用图标。我有这个漂亮的应用程序图标，我不想失去它。

922
00:48:17,628 --> 00:48:21,630
所以我要去这里看看我的资产和我的新资产

923
00:48:21,699 --> 00:48:26,201
摆脱空白的应用程序图标，只需拖动这个应用程序图标

924
00:48:26,270 --> 00:48:31,340
在这里。就是这样了。所以我基本上已经结束了

925
00:48:31,409 --> 00:48:35,644
从我的旧表情符号艺术到新的表情符艺术。但

926
00:48:35,712 --> 00:48:38,581
我们要做的第一件事就是去吧

927
00:48:38,649 --> 00:48:41,283
使这个表情符艺术文件业务工作。

928
00:48:41,352 --> 00:48:43,753
所以我们去做吧。我们的表情符文艺术文件在哪里？

929
00:48:43,821 --> 00:48:45,921
就在这里。这是我刚刚改名的东西。

930
00:48:45,990 --> 00:48:49,324
只有这两种方法正在做东西，

931
00:48:49,393 --> 00:48:50,659
我们知道如何做到这一点，

932
00:48:50,728 --> 00:48:53,462
我们只是在做这个。关于这件事的一件事是，

933
00:48:53,531 --> 00:48:56,932
你注意到内容返回一个任何不是数据，

934
00:48:57,001 --> 00:49:00,069
那是因为这个Any可能是一个文件包装器。目录

935
00:49:00,137 --> 00:49:02,905
充满文件是一种表示文件的方式

936
00:49:02,973 --> 00:49:06,075
是一个数据是。但通常这将返回一个数据。

937
00:49:06,143 --> 00:49:09,211
其实看，默认返回一个空白数据。所以在这里，

938
00:49:09,279 --> 00:49:11,680
做这些任何一个，

939
00:49:11,749 --> 00:49:15,918
我们实际上需要在文档中传递给我们的模型。

940
00:49:15,986 --> 00:49:18,854
所以，我在这里也会有一个var emojiArt

941
00:49:18,923 --> 00:49:20,990
这将是一个EmojiArt。和

942
00:49:21,058 --> 00:49:24,693
任何时候我想从我的控制器中保存我的模型，我只是

943
00:49:24,761 --> 00:49:28,497
拿我的控制器的模型，并把它放在文档中

944
00:49:28,566 --> 00:49:31,567
那么文档就知道该从那里做些什么。

945
00:49:31,636 --> 00:49:34,936
因此，让我们继续并返回这个emojiArt.json和

946
00:49:35,005 --> 00:49:37,640
如果它没有JSON表示，

947
00:49:37,708 --> 00:49:41,877
那么我们将返回Data，它是一个空白文档。

948
00:49:41,946 --> 00:49:44,080
空文件，我们知道如何处理，

949
00:49:44,148 --> 00:49:46,982
因为我们的文件总是空白。

950
00:49:47,051 --> 00:49:50,485
然后这是另一种方式，在这里我们有一个

951
00:49:50,554 --> 00:49:54,323
传给我们。数据传递给我们，我们想把它变成

952
00:49:54,392 --> 00:49:57,226
表情符号艺术。所以我要说如果我可以让json =，

953
00:49:57,295 --> 00:49:59,461
作为数据传递给我的内容，

954
00:49:59,530 --> 00:50:01,964
因为我不处理文件包装。

955
00:50:02,033 --> 00:50:05,233
如果这是一个文件包装，我不会处理这个问题。

956
00:50:05,302 --> 00:50:08,336
然后，我要把我的表情艺术再次设定为等于，

957
00:50:08,405 --> 00:50:11,773
使用我所做的构造函数来获取数据和

958
00:50:11,842 --> 00:50:13,408
把它变成表情符艺术。

959
00:50:13,477 --> 00:50:17,212
这可能会失败，这很好。这将是零和

960
00:50:17,281 --> 00:50:20,449
那么它不会保存文档。它不能保存零

961
00:50:20,517 --> 00:50:25,187
文件。而且，我在这两个方面都谈到了这一点

962
00:50:25,255 --> 00:50:29,892
案例。这是一个UTI。像public.json是一个UTI或

963
00:50:29,960 --> 00:50:35,030
edu.standford.cs193.emojiart可能是UTI。

964
00:50:35,099 --> 00:50:36,998
类型的唯一标识符。

965
00:50:37,067 --> 00:50:40,102
现在我们并不在乎，因为我们只开放一件事

966
00:50:40,171 --> 00:50:43,171
或者我们打开的任何东西，JSON或emojiArt或其他，

967
00:50:43,240 --> 00:50:46,074
无论如何我们都只是一个JSON数据。所以我们不关心

968
00:50:46,143 --> 00:50:48,744
类型，但有些应用程序可能会打开多个不同的类型。

969
00:50:48,813 --> 00:50:50,646
他们可能需要知道它是什么类型

970
00:50:50,715 --> 00:50:53,715
成功打开或保存它。就是这样，这就是全部

971
00:50:53,784 --> 00:50:57,286
我们需要做一个emojiArt文档。我们完成了，

972
00:50:57,355 --> 00:51:00,489
现在我们可以使用UIDocument的所有API，比方说，

973
00:51:00,558 --> 00:51:03,659
同步打开和保存，通过iCloud工作，

974
00:51:03,727 --> 00:51:06,928
自动化，自动保存，所有这些工作都适用

975
00:51:06,997 --> 00:51:09,331
只要我们实施这些事情就免费。

976
00:51:09,399 --> 00:51:13,235
所以让我们在emojiArt中使用所有这些东西

977
00:51:13,304 --> 00:51:16,939
在这里查看控制器来替换我们所在的地方

978
00:51:17,008 --> 00:51:20,842
实际上直接在这里访问文件系统。所以

979
00:51:20,911 --> 00:51:25,513
我们想摆脱这一点，所以让我们删除所有。和

980
00:51:25,582 --> 00:51:28,017
让我们删除所有这些。和

981
00:51:28,085 --> 00:51:32,254
我们会用同样的东西来替代它

982
00:51:32,323 --> 00:51:35,690
基元，但使用文档。现在，要做到这一点，

983
00:51:35,759 --> 00:51:38,560
我们显然需要有一个变量是文档

984
00:51:38,629 --> 00:51:40,228
因为我们必须能够与我们自己的文件进行交谈。

985
00:51:40,297 --> 00:51:42,665
所以我们会有一个叫做var的

986
00:51:42,733 --> 00:51:45,500
这是一个EmojiArtDocument类型的文档。这是

987
00:51:45,569 --> 00:51:49,938
将从文件选择器的代码中设置，对吧？

988
00:51:50,007 --> 00:51:51,439
当文件选择器选择一个文件时，

989
00:51:51,508 --> 00:51:53,875
我们将在我们的新MVC中设置我们的文档

990
00:51:53,944 --> 00:51:57,012
那么它就会神奇地使用所有东西来展示它的东西

991
00:51:57,081 --> 00:51:59,648
文档API。那么让我们来谈谈，

992
00:51:59,717 --> 00:52:03,151
视图将首先出现。当我们的第一个文件第一

993
00:52:03,220 --> 00:52:05,587
出现，我们需要打开我们的文档。

994
00:52:05,656 --> 00:52:10,091
所以我们只是说，文档？.open。就这样

995
00:52:10,160 --> 00:52:12,695
我们不得不说。它带有一个完成处理程序

996
00:52:12,763 --> 00:52:16,064
那会告诉你这是否成功。

997
00:52:16,133 --> 00:52:18,833
我们通常要检查这一点，并说，如果我们是，

998
00:52:18,902 --> 00:52:21,303
有成功，那么我们会做一些事情。

999
00:52:21,372 --> 00:52:23,639
我们想在这里做什么，也许想要设置

1000
00:52:23,708 --> 00:52:30,912
我们的标题等于文件的本地化名称。这个

1001
00:52:30,981 --> 00:52:33,749
本地化的名称只是来自URL，它就像最后一个

1002
00:52:33,817 --> 00:52:35,851
没有文件扩展名的URL的一部分放在那里，

1003
00:52:35,919 --> 00:52:38,386
所以很好。我们当然需要自我

1004
00:52:38,455 --> 00:52:40,989
插入一个闭包。但是我们想要的最重要的事情

1005
00:52:41,058 --> 00:52:46,361
如果我们成功打开文档，就是设置我们的模型

1006
00:52:46,430 --> 00:52:51,567
到文档能够通过的模型

1007
00:52:51,635 --> 00:52:56,438
打开该文件。所以这个文件有一个表情符艺术

1008
00:52:56,507 --> 00:53:01,176
它从文件中获得。我们有我们的模型。我们想要得到它。

1009
00:53:01,245 --> 00:53:04,212
所以这是我们在所有这些方面所做的主要事情

1010
00:53:04,281 --> 00:53:07,582
记录事物，是为了设定，获取我们的模型。

1011
00:53:07,651 --> 00:53:10,819
现在怎么样保存？好，

1012
00:53:10,888 --> 00:53:17,259
我们实际上并不真的保存，我们做自动保存。

1013
00:53:17,328 --> 00:53:21,529
那么我们如何做自动保存？唯一重要的是

1014
00:53:21,598 --> 00:53:25,868
与自动保存是你告诉UIDocument的东西

1015
00:53:25,936 --> 00:53:28,437
已经改变。否则，它不会浪费时间

1016
00:53:28,505 --> 00:53:31,239
自动保存一些没有改变的东西。和

1017
00:53:31,308 --> 00:53:36,111
你首先要告诉文档看看

1018
00:53:36,180 --> 00:53:40,849
在你的模型中，所以我们想把它设置为我们的模型。

1019
00:53:40,918 --> 00:53:44,186
然后你告诉文档发生了变化。

1020
00:53:44,255 --> 00:53:47,723
因此，您更新了更改计数，并说明了这一更改

1021
00:53:47,791 --> 00:53:51,593
已经完成了。顺便说一下，这可以撤消，重做或完成。

1022
00:53:51,662 --> 00:53:53,728
所以我们不是在谈论撤销管理器

1023
00:53:53,797 --> 00:53:56,531
我无法真正向你展示。但是其他选项已经完成，

1024
00:53:56,600 --> 00:53:58,333
因为这意味着改变已经完成。

1025
00:53:58,402 --> 00:54:01,636
顺便说一下，我只会做这个文件

1026
00:54:01,705 --> 00:54:05,140
emojiArt不是零。好吧，如果我们还没有真正开始

1027
00:54:05,208 --> 00:54:08,343
一份文件，更新其更改计数是无用的

1028
00:54:08,412 --> 00:54:13,816
那里。现在这很奇怪，因为我们在说和

1029
00:54:13,884 --> 00:54:16,084
注意到我们的文件改变了，

1030
00:54:16,152 --> 00:54:20,522
因为用户按下保存按钮。这很奇怪。

1031
00:54:20,591 --> 00:54:23,925
真的，如果有什么变化，我们应该注意到变化。

1032
00:54:23,994 --> 00:54:26,494
有人拖出另一个表情符号，他们调整了大小，

1033
00:54:26,563 --> 00:54:29,230
他们放置了不同的背景网址。那是时候

1034
00:54:29,299 --> 00:54:31,834
我们应该“保存”。实际上，这种方法甚至不应该

1035
00:54:31,902 --> 00:54:34,069
称为保存，它应该被称为文档更改。

1036
00:54:34,138 --> 00:54:37,339
那么不幸的是，时间是最重要的事情之一

1037
00:54:37,408 --> 00:54:39,041
它会切断我无法完成的事情，

1038
00:54:39,110 --> 00:54:40,509
由于这个期中进来了，

1039
00:54:40,578 --> 00:54:45,079
正在将该保存，或文件更改跟踪。

1040
00:54:45,148 --> 00:54:47,182
为什么这是一件有趣的事情？

1041
00:54:47,251 --> 00:54:52,086
那么，因为我们认为这是被跟踪的，对吗？

1042
00:54:52,155 --> 00:54:54,957
我们的视图是什么知道什么时候我们调整了某些东西或

1043
00:54:55,025 --> 00:54:55,958
拖了一些东西。

1044
00:54:56,026 --> 00:54:58,861
所以我们的视图需要回到我们的控制器并且说，

1045
00:54:58,929 --> 00:55:02,430
嘿，一些变化。那么，它不能回话给我们

1046
00:55:02,499 --> 00:55:05,400
控制器，除了盲目和结构化的，对吗？所以

1047
00:55:05,469 --> 00:55:08,503
我们怎么会，你们中的任何一个人，你如何建议我们

1048
00:55:08,572 --> 00:55:11,506
从我们的视图谈谈回到我们的控制器告诉它，嘿，

1049
00:55:11,575 --> 00:55:14,510
此文件已更改，此文件已更改。

1050
00:55:14,578 --> 00:55:16,712
你会建议什么，机制？

1051
00:55:23,653 --> 00:55:26,154
所以一个建议是，让我们在我们的变量

1052
00:55:26,223 --> 00:55:29,157
这是对我们控制器的参考。和

1053
00:55:29,226 --> 00:55:32,060
这是MVC不允许的，对吧？视图无法通话

1054
00:55:32,129 --> 00:55:37,366
以这种方式对其控制器。所以我们来试一下委托。

1055
00:55:37,434 --> 00:55:40,035
表格视图与其控制器对话的方式相同，

1056
00:55:40,103 --> 00:55:42,704
这是一个代表团，它使用委派的滚动视图，

1057
00:55:42,773 --> 00:55:45,573
这就是我们必须要做的。所以我们要建立

1058
00:55:45,642 --> 00:55:48,410
我们自己的代表团，我们有一个emojiArt视图

1059
00:55:48,479 --> 00:55:50,745
代表。这就是我们要做的。不幸，

1060
00:55:50,814 --> 00:55:52,314
我没有时间这样做，但这就是我们要做的。

1061
00:55:52,382 --> 00:55:54,115
所以我不想让你在这里得到你应该的想法

1062
00:55:54,184 --> 00:55:56,017
在文档应用程序中保存按钮。

1063
00:55:56,086 --> 00:55:57,719
你永远不应该有一个保存按钮。

1064
00:55:57,788 --> 00:55:59,354
它应该知道什么时候事情发生变化

1065
00:55:59,423 --> 00:56:03,091
只需调用updateChangCount即可。

1066
00:56:03,160 --> 00:56:05,627
但既然我们没有这个，我们会有我们的保存按钮，

1067
00:56:05,696 --> 00:56:09,865
我们会在节省时告诉它。好吧？还有什么呢

1068
00:56:09,934 --> 00:56:12,600
我们必须在这里做？如何关闭我们的文档。

1069
00:56:12,669 --> 00:56:16,004
现在我们只有一个文件untitled.json，但是

1070
00:56:16,073 --> 00:56:18,606
我们只是要问，添加一个文件选择器会让

1071
00:56:18,675 --> 00:56:20,508
我们选择许多不同的文件。所以

1072
00:56:20,577 --> 00:56:22,610
我们需要一种方式来关闭这个文件

1073
00:56:22,679 --> 00:56:24,312
我们可以打开另一个文件。

1074
00:56:24,381 --> 00:56:29,284
所以我要回去添加一个关闭按钮到我们的用户界面。

1075
00:56:29,352 --> 00:56:32,354
我会从保存中把它放在另一边

1076
00:56:32,423 --> 00:56:36,525
在那边。我们要去这里。bar按钮再次，

1077
00:56:38,261 --> 00:56:40,862
bar按钮在这里。实际上有一个标准的

1078
00:56:40,931 --> 00:56:42,864
那。它实际上叫做Done，

1079
00:56:42,933 --> 00:56:47,068
因为你已经完成了这个文件，就在那里。和

1080
00:56:47,137 --> 00:56:52,106
我们然后将控制拖动，并且

1081
00:56:52,175 --> 00:56:55,978
我会把它放在这里。我会在这里采取行动。

1082
00:56:56,046 --> 00:56:58,713
我会把它叫得很近，我可以把它叫做完成，但是

1083
00:56:58,782 --> 00:57:02,851
我会调用给它。现在让我们回去

1084
00:57:02,920 --> 00:57:08,189
在这里全宽，回到这里。好吧，

1085
00:57:08,258 --> 00:57:11,093
所以我们要在结束时做什么？那么，为一个文件

1086
00:57:11,161 --> 00:57:15,564
应用程序，这很容易。你只会说文档？.close（）。

1087
00:57:15,632 --> 00:57:18,666
现在，它也有一个成功完成处理程序，但是

1088
00:57:18,735 --> 00:57:22,037
我并不在乎，因为我不会做任何事情。

1089
00:57:22,106 --> 00:57:23,471
无论成功与否，

1090
00:57:23,540 --> 00:57:25,907
我只是试图关闭它，并希望它会和

1091
00:57:25,976 --> 00:57:28,476
99％的时间将会是。我知道，

1092
00:57:28,545 --> 00:57:31,613
抓住你的错误和类似的东西。遇到问题

1093
00:57:31,682 --> 00:57:33,682
某种原因，关闭和有问题，但是

1094
00:57:33,750 --> 00:57:35,350
我们真正能做的最好的就是尝试关闭和

1095
00:57:35,419 --> 00:57:37,251
走着瞧吧。我要做的另一件事是我

1096
00:57:37,320 --> 00:57:40,788
要保存（）之前，现在因为我没有自动

1097
00:57:40,857 --> 00:57:43,892
更改跟踪，我想在关闭之前保存。如果我有

1098
00:57:43,961 --> 00:57:47,362
自动更改跟踪，我不会保存在这里。我会

1099
00:57:47,431 --> 00:57:49,330
删除这一行代码。事实上，我将要删除

1100
00:57:49,399 --> 00:57:52,234
这段代码当我在演讲结束后发布这段代码时，

1101
00:57:52,302 --> 00:57:54,369
因为我将在那里进行跟踪。

1102
00:57:54,438 --> 00:57:56,237
现在注意我没有任何参数，

1103
00:57:56,306 --> 00:57:57,472
因为保存需要一个bar

1104
00:57:57,541 --> 00:58:00,208
按钮项目，我没有一个。这是一个很酷的诀窍。

1105
00:58:00,277 --> 00:58:01,809
我会让这是一个可选的和

1106
00:58:01,878 --> 00:58:05,814
有它默认为零。通过这样做，现在我可以调用了

1107
00:58:05,882 --> 00:58:08,050
没有任何东西保存，它默认为零和

1108
00:58:08,118 --> 00:58:10,151
我不在这里使用这个bar按钮项目，

1109
00:58:10,220 --> 00:58:15,156
一切都很好。每个人都得到了这一切？好吧，现在，

1110
00:58:15,225 --> 00:58:17,659
测试所有这些，就是这样。看看我们如何取代所有

1111
00:58:17,728 --> 00:58:20,796
那东西在我们的，这是文件系统现在与这一切

1112
00:58:20,864 --> 00:58:23,298
漂亮的代码是非常容易理解和可读的？

1113
00:58:23,367 --> 00:58:26,602
打开我们的文档，关闭我们的文档，更新文档。

1114
00:58:26,670 --> 00:58:30,238
我打算在我看来确实加载了我的文档

1115
00:58:30,307 --> 00:58:33,174
成为Untitled.json。最终，它会是

1116
00:58:33,243 --> 00:58:35,277
那个选择器的东西，但现在它会是这样的。

1117
00:58:35,345 --> 00:58:37,145
所以在viewDidLoad中，只是一个，这只是一个测试。

1118
00:58:37,214 --> 00:58:38,780
我要从这里取出这个，

1119
00:58:38,849 --> 00:58:40,415
在我们做这个测试后。和

1120
00:58:40,484 --> 00:58:45,320
我要在这里做的是得到那个，

1121
00:58:45,388 --> 00:58:50,092
该json网址再次。你可以看到为什么我把它放进去，

1122
00:58:50,160 --> 00:58:51,659
那里的代码，因为我必须这样输入

1123
00:58:51,728 --> 00:58:54,729
多次。而我要在这里做的只是

1124
00:58:54,798 --> 00:58:56,497
设置我的文档，对不对？

1125
00:58:56,566 --> 00:59:00,302
这就是这个bar。它必须是EmojiArtDocument，

1126
00:59:00,370 --> 00:59:04,038
我打算把它设定为一个EmojiArt，

1127
00:59:04,107 --> 00:59:07,242
那么我们在那里耗尽电池。文档和

1128
00:59:07,311 --> 00:59:11,713
记住UIDocuments只有一个初始化器，

1129
00:59:11,781 --> 00:59:16,384
这是网址。所以这是fileURL，

1130
00:59:16,453 --> 00:59:22,557
网址。有意义吗？

1131
00:59:22,626 --> 00:59:26,261
有我紧密的花括号，我们走了。就是这样了。

1132
00:59:26,330 --> 00:59:29,664
所以我只是做这个测试。所以现在，

1133
00:59:29,732 --> 00:59:33,535
当我们启动我们的应用程序时，它应该加载该Untitled.json

1134
00:59:33,604 --> 00:59:36,104
因为我们立即将其设置为我们的文档，

1135
00:59:36,173 --> 00:59:37,739
而文件只是做它的事情。

1136
00:59:37,808 --> 00:59:41,242
所以让我们继续看看这里。

1137
00:59:41,311 --> 00:59:44,713
运行，让你看看发生了什么。

1138
00:59:51,554 --> 00:59:54,823
好的，看，它加载了Untitled.json。和

1139
00:59:54,892 --> 00:59:57,759
让我们把一架小飞机飞过那里，然后

1140
00:59:57,827 --> 01:00:01,195
我会打保存让它知道有一个变化

1141
01:00:01,264 --> 01:00:06,801
到文档，然后点击完成。现在，如果我退出和

1142
01:00:06,870 --> 01:00:11,439
再次运行。希望我们拭目以待

1143
01:00:11,508 --> 01:00:13,975
飞机在那里，我们做到了。好的，UIDocument正在这样做

1144
01:00:14,044 --> 01:00:16,177
所有的文件系统的东西都是为了

1145
01:00:16,246 --> 01:00:18,413
我们。但现在我们有了UIDocument，

1146
01:00:18,481 --> 01:00:21,149
我们可以让我们的应用程序启动

1147
01:00:21,218 --> 01:00:23,151
发射和展示这个，发射和

1148
01:00:23,220 --> 01:00:25,420
显示文件选择的东西，文件浏览器的东西，

1149
01:00:25,488 --> 01:00:28,222
像文件应用程序。所以让我们把这块

1150
01:00:28,291 --> 01:00:31,526
这里的难题。在我做任何事之前，

1151
01:00:31,595 --> 01:00:34,763
我要确保我删除这个viewDidLoad。

1152
01:00:34,832 --> 01:00:37,298
我要去掉那个，因为我不会

1153
01:00:37,367 --> 01:00:41,436
将我的文档设置为这个Untitled.json，我将成为

1154
01:00:41,505 --> 01:00:44,272
将其设置为任何文档视图浏览器

1155
01:00:44,340 --> 01:00:48,110
希望我拥有它。好，我们在这里。

1156
01:00:48,178 --> 01:00:50,578
这是文档浏览器视图控制器，

1157
01:00:50,647 --> 01:00:53,414
这是所有魔法都发生在这里的事情。

1158
01:00:53,483 --> 01:00:57,419
我们必须做的一件事就是让这个人进入循环

1159
01:00:57,487 --> 01:01:01,622
回到我们的故事板并且不再有入口点

1160
01:01:01,691 --> 01:01:05,993
成为我们的MVC。相反，它会是这样。我们会成为的

1161
01:01:06,062 --> 01:01:09,664
负责从这里进行介绍

1162
01:01:09,733 --> 01:01:12,333
这显示我们的文件。所以，让我们看看我们如何做到这一点。

1163
01:01:12,402 --> 01:01:15,770
好吧，让我们来谈谈我所谈论的所有部分

1164
01:01:15,838 --> 01:01:18,840
这里的幻灯片。让我们做viewDidLoad。让我们来配置。

1165
01:01:18,908 --> 01:01:22,744
所以，当然，我们想要或者委托= self，我们需要这个。

1166
01:01:22,813 --> 01:01:25,513
另外，我们不会允许选择多个

1167
01:01:25,581 --> 01:01:28,015
项目，因为我们只知道如何显示一个EmojiArtDocument

1168
01:01:28,084 --> 01:01:32,454
一次。允许文档是真实的，嗯，

1169
01:01:32,522 --> 01:01:36,224
是的，现在。然后这里是东西，色调，

1170
01:01:36,293 --> 01:01:38,059
我不会改变它的颜色或外观。

1171
01:01:38,128 --> 01:01:40,996
你可以玩这个，看看你喜欢那里。

1172
01:01:41,064 --> 01:01:43,264
所以，我们要回过头去查看DadLoad和

1173
01:01:43,333 --> 01:01:44,765
在一瞬间解决这个问题。

1174
01:01:44,834 --> 01:01:48,002
但现在让我们来看看didRequestDocumentCreationWit-

1175
01:01:48,071 --> 01:01:51,372
hHandler。这就是它说的地方，给我的URL

1176
01:01:51,441 --> 01:01:53,508
一个空白的文件，因为有人想创建一个。

1177
01:01:53,577 --> 01:01:55,943
而且我会在这里让我们很容易。

1178
01:01:56,012 --> 01:01:58,013
我会删除那里的所有内容

1179
01:01:58,081 --> 01:02:00,948
只需调用它给我的importHandler即可。

1180
01:02:01,017 --> 01:02:04,186
看，它给我这个importHandler？它需要一个URL，

1181
01:02:04,254 --> 01:02:07,221
并复制或移动。我要复制，

1182
01:02:07,290 --> 01:02:12,293
用一个模板来调用它，它将成为一个URL和.copy。

1183
01:02:12,362 --> 01:02:19,467
我所要做的就是制作一个URL，var template：URL。

1184
01:02:19,536 --> 01:02:21,936
使这个模板指向一些空白文档。

1185
01:02:22,005 --> 01:02:26,707
我会在viewDidLoad这里做这个。和

1186
01:02:26,776 --> 01:02:28,943
我在这里输入。和

1187
01:02:29,012 --> 01:02:30,779
要做到这一点，我只是想获得一个URL。

1188
01:02:30,847 --> 01:02:33,147
这次不进我的文档目录因为

1189
01:02:33,216 --> 01:02:35,350
这是我一直在复制的空白文档。我不

1190
01:02:35,419 --> 01:02:38,753
希望它出现在文件中，当这个人去

1191
01:02:38,822 --> 01:02:41,856
并看起来那里。所以我会把它放在applicationSupport中。

1192
01:02:41,924 --> 01:02:44,125
所以，applicationSupport是一个很好的地方

1193
01:02:44,194 --> 01:02:46,928
是幕后的一种。但他们是永久的。

1194
01:02:46,997 --> 01:02:48,529
我想要这个模板坚持下去。

1195
01:02:48,598 --> 01:02:50,265
我不希望它在缓存中并被删除，

1196
01:02:50,334 --> 01:02:52,033
尽管我可能会把它放在缓存中

1197
01:02:52,102 --> 01:02:54,669
我总是可以在viewDidLoad中重新创建它。

1198
01:02:54,738 --> 01:02:56,138
但无论如何，这是网址。

1199
01:02:56,206 --> 01:02:58,206
我打算称它为Untitled.json，只是为了

1200
01:02:58,274 --> 01:02:59,040
旧时代的缘故。

1201
01:02:59,109 --> 01:03:01,642
我把它放在我的applicationSupportDirectory中。

1202
01:03:01,711 --> 01:03:04,712
然而，我想在这里做的，是确保我创造

1203
01:03:04,781 --> 01:03:07,382
这个文件。所以我有了它的URL。所以要创建它，

1204
01:03:07,451 --> 01:03:11,486
我会说，如果模板不是零。换一种说法，

1205
01:03:11,554 --> 01:03:14,389
我能够创建我应该能够访问的URL。

1206
01:03:14,458 --> 01:03:18,126
我现在要设置allowDocumentCreation。

1207
01:03:18,194 --> 01:03:20,795
这个变种在这里，而不是事实。

1208
01:03:20,864 --> 01:03:23,665
我将把它设置为询问的结果

1209
01:03:23,734 --> 01:03:26,334
FileManager，默认的FileManager，

1210
01:03:26,403 --> 01:03:30,371
创建该文件。所以它有一个名为createFile的方法，

1211
01:03:30,440 --> 01:03:33,608
给它的文件路径，模板的路径，和

1212
01:03:33,677 --> 01:03:35,009
你用一些内容创建它。

1213
01:03:35,078 --> 01:03:37,745
我会把它变成空的，因为它只是一个空白的文件，或者

1214
01:03:37,814 --> 01:03:40,481
一个空文档，我甚至不需要任何文件属性，

1215
01:03:40,550 --> 01:03:43,184
所以让我们摆脱这一点。现在createFile是一个不错的方法

1216
01:03:43,253 --> 01:03:45,353
创建一个文件，因为它不会抛出或

1217
01:03:45,421 --> 01:03:48,389
类似的东西，并且它返回一个布尔值

1218
01:03:48,458 --> 01:03:50,659
文件已被创建或已经存在，

1219
01:03:50,727 --> 01:03:52,460
这正是我想要的。

1220
01:03:52,529 --> 01:03:55,797
如果这是真的，那么我将允许创建文档。

1221
01:03:55,865 --> 01:03:57,131
否则，我不会允许它，

1222
01:03:57,200 --> 01:04:00,301
因为我无法创建模板。看看我为什么这么做

1223
01:04:00,370 --> 01:04:03,905
那里吗？所以这是一个不错的小动作。

1224
01:04:03,973 --> 01:04:05,840
当你创建你的模板时，

1225
01:04:05,909 --> 01:04:09,377
如果由于某种原因未能创建它，则可以这样做。

1226
01:04:09,446 --> 01:04:12,547
所以现在这个importHandler将会正常工作。我将它传递给

1227
01:04:12,615 --> 01:04:15,383
我在这里创建的这个模板，并将其复制

1228
01:04:15,451 --> 01:04:18,386
脱离应用程序支持到文档目录中。

1229
01:04:18,454 --> 01:04:21,089
这些其他的东西，我们甚至不需要接触。

1230
01:04:21,158 --> 01:04:23,791
这些是人们点击时会被调用的东西

1231
01:04:23,860 --> 01:04:26,026
文档，didPickDocumentURLs。

1232
01:04:26,095 --> 01:04:29,363
didImportDocument是当其他一些应用程序，如文件应用程序，

1233
01:04:29,432 --> 01:04:31,566
要求你打开你的一个文件。

1234
01:04:31,634 --> 01:04:34,469
并注意到他们都在做同一班轮，

1235
01:04:34,537 --> 01:04:37,272
也就是说，请在该URL上提供文档。

1236
01:04:37,340 --> 01:04:41,008
这意味着，把你的ViewController来显示它。

1237
01:04:41,077 --> 01:04:44,545
好的，所以我们，顺便提一下，这里有一个错误，

1238
01:04:44,614 --> 01:04:46,681
请参阅failedToImportDocumentAt。

1239
01:04:46,749 --> 01:04:48,316
你真的应该在这里提醒一下，但是

1240
01:04:48,385 --> 01:04:49,884
我没有告诉你如何发布警报。

1241
01:04:49,953 --> 01:04:51,318
我将在下周展示给你，

1242
01:04:51,387 --> 01:04:53,988
所以你不能这样做。但是，你真的应该提醒一下

1243
01:04:54,057 --> 01:04:55,790
说，无法加载文件，或

1244
01:04:55,858 --> 01:04:58,192
无法打开文件，或其他。好，如此

1245
01:04:58,261 --> 01:05:00,728
这里是现在的文件，这将提供它。和

1246
01:05:00,797 --> 01:05:03,665
我会基本上做我在幻灯片中向你展示的内容

1247
01:05:03,733 --> 01:05:06,100
在这里，我会得到我的故事板。

1248
01:05:06,169 --> 01:05:08,870
已经有代码可以在这里获取storyboard

1249
01:05:08,939 --> 01:05:12,206
来自该模板。我将用storyBoard来

1250
01:05:12,275 --> 01:05:14,409
获取我想要呈现的ViewController。

1251
01:05:14,478 --> 01:05:16,144
现在，这里有点棘手，

1252
01:05:16,212 --> 01:05:19,080
我想要呈现的ViewController实际上并不是

1253
01:05:19,149 --> 01:05:22,383
我的表情符艺术ViewController。这是导航控制器

1254
01:05:22,452 --> 01:05:24,785
它在，每个人都明白吗？所以

1255
01:05:24,854 --> 01:05:27,922
我必须以某种方式实例化这个导航控制器，

1256
01:05:27,991 --> 01:05:29,523
这也将带来这个。

1257
01:05:29,592 --> 01:05:32,226
所以我需要给这个人一个名字，所以我只是想

1258
01:05:32,295 --> 01:05:35,296
选择它，转到Identity Inspector并为其命名。

1259
01:05:35,364 --> 01:05:40,301
我会调用给它，我的DocumentMVC。它可以是任何

1260
01:05:40,370 --> 01:05:43,671
我们想要的名字，但DocumentMVC就是那样的，

1261
01:05:43,740 --> 01:05:46,174
在我的DocumentMVC机制的顶部。

1262
01:05:46,243 --> 01:05:50,946
所以现在我有了这个名字，我可以回到这里说 -

1263
01:05:54,718 --> 01:05:57,285
让我的文档VC

1264
01:05:57,354 --> 01:06:03,524
= storyBoard.instantiateViewCon-

1265
01:06:03,593 --> 01:06:11,099
troller（withIdentifier：“DocumentMVC”）。

1266
01:06:11,168 --> 01:06:13,101
所以现在我们有了我们的DocumentMVC。

1267
01:06:13,170 --> 01:06:17,038
现在我只是要配置它，然后我

1268
01:06:17,106 --> 01:06:21,508
通过说出现（文件MVC）来呈现它，

1269
01:06:21,577 --> 01:06:25,146
VC宁可。和动画：真实，我想动画：真实的情况下

1270
01:06:25,215 --> 01:06:28,116
有人在文件中点击它，我们希望它滑动，

1271
01:06:28,184 --> 01:06:29,884
对？我们不只是想让它出现，

1272
01:06:29,953 --> 01:06:31,219
我们希望它从底部向上滑动。

1273
01:06:31,287 --> 01:06:33,754
甚至有一种方法可以让这个像从图标中伸出

1274
01:06:33,823 --> 01:06:35,790
在文件的东西，这是非常酷。

1275
01:06:35,859 --> 01:06:36,991
这甚至不那么难，但是

1276
01:06:37,060 --> 01:06:39,460
不幸的是我没有时间向你展示，但是

1277
01:06:39,529 --> 01:06:42,096
只知道有一种方法可以做到这一点。这是会的

1278
01:06:42,165 --> 01:06:45,299
正常情况下从底部呈现向上滑动。但

1279
01:06:45,368 --> 01:06:48,570
这个DocumentMVC中有一个emojiViewController

1280
01:06:48,638 --> 01:06:50,471
我们需要设置文件。所以

1281
01:06:50,540 --> 01:06:52,907
我准备做同样的事情。

1282
01:06:52,976 --> 01:06:57,912
我要说，如果我可以让我的emojiViewController

1283
01:06:57,980 --> 01:07:02,517
= documentViewController，它的内容。

1284
01:07:02,585 --> 01:07:05,419
请记住内容，我之前告诉过你，让我们来看看

1285
01:07:05,488 --> 01:07:08,255
去看看它只是为了提醒你，我在公用事业。

1286
01:07:08,324 --> 01:07:12,092
内容是一个UI ViewController方法的权利

1287
01:07:12,161 --> 01:07:17,265
这里，只是说，如果我是导航控制器，返回

1288
01:07:17,334 --> 01:07:20,468
我的内容。否则，如果我不是导航控制器，

1289
01:07:20,536 --> 01:07:22,437
只是回报我自己。所以这会让它如此

1290
01:07:22,505 --> 01:07:24,639
我刚刚写的这段代码会起作用，

1291
01:07:24,707 --> 01:07:28,042
无论它是否包裹在导航控制器中。

1292
01:07:28,111 --> 01:07:34,282
所以将内容作为EmojiArtViewController获取。

1293
01:07:34,350 --> 01:07:42,257
所以，如果我能得到EmojiArtViewController，

1294
01:07:42,325 --> 01:07:45,860
我想我应该调用这个EmojiArtViewController

1295
01:07:45,929 --> 01:07:48,963
在那里很好。然后我可以设置它的文档，

1296
01:07:49,032 --> 01:07:52,233
EmojiArtViewController.document =和

1297
01:07:52,302 --> 01:07:55,536
文件等于什么？它的意思是，

1298
01:07:55,605 --> 01:07:59,106
=我们知道的一个新的EmojiArtDocument

1299
01:07:59,175 --> 01:08:03,478
构造函数是fileURL，URL是什么？

1300
01:08:03,546 --> 01:08:08,883
这是他们希望我们呈现的URL，documentURL。

1301
01:08:13,289 --> 01:08:19,794
这是实例成员，大写E，

1302
01:08:19,862 --> 01:08:24,566
我们走了。我认为它需要一个静态方法。

1303
01:08:26,602 --> 01:08:29,603
我们需要做的另一件事是类型。马上，

1304
01:08:29,672 --> 01:08:32,540
如果我们在这里查看我们的项目设置，

1305
01:08:32,609 --> 01:08:35,743
我要去看看我们的项目设置。

1306
01:08:35,812 --> 01:08:37,812
我们在这里查看信息，

1307
01:08:37,880 --> 01:08:42,683
我们可以打开的文档类型是图像。和

1308
01:08:42,752 --> 01:08:47,521
我们不打开图像，我们打开JSON文件。 public.JSON。

1309
01:08:47,590 --> 01:08:51,759
而且，就像我说的，当我在演讲结束后发布代码时，

1310
01:08:51,828 --> 01:08:54,762
我也会在这里做这个导出的UTI。和

1311
01:08:54,831 --> 01:08:57,632
制作一种新型的表情艺术，然后把它作为我们的类型。

1312
01:08:57,701 --> 01:09:02,503
但是，现在，我们会说我们做JSON文件。

1313
01:09:02,572 --> 01:09:04,972
好吧，如果我在这里没有忘记任何东西，

1314
01:09:05,041 --> 01:09:10,111
它应该工作。好的，看看那个，

1315
01:09:10,180 --> 01:09:12,246
已经可以看到我们的应用程序完全不同。

1316
01:09:12,314 --> 01:09:18,018
它向我们展示了一个与文件应用程序相似的UI，

1317
01:09:18,087 --> 01:09:20,855
对？它有文件夹和所有的东西，

1318
01:09:20,924 --> 01:09:22,724
我们甚至可以在这里转到iCloud Drive。

1319
01:09:22,792 --> 01:09:26,160
我们可以在我的iPad上，在那里，EmojiArt，让我们看看

1320
01:09:26,228 --> 01:09:30,964
内。好的，有我们的Untitled.JSON，让我们打开它。

1321
01:09:31,033 --> 01:09:36,470
喔，它的工作原理！让我们来关闭这个，它不关闭，

1322
01:09:36,539 --> 01:09:39,673
看，我按完成，它不关闭。

1323
01:09:39,742 --> 01:09:43,311
当我们的MVC出现时，它占据了整个屏幕，

1324
01:09:43,379 --> 01:09:45,746
因为我们在这里介绍它，

1325
01:09:45,815 --> 01:09:50,118
我们如何让它消失？本质上，我们如何解雇它？

1326
01:09:50,186 --> 01:09:52,987
那么，我们在ViewController本身，或者

1327
01:09:53,056 --> 01:09:56,724
该ViewController想要消除自己。

1328
01:09:56,792 --> 01:09:58,893
而我们要这样做的方式是密切合作的，

1329
01:09:58,962 --> 01:10:01,028
当你在那里点击完成按钮时。

1330
01:10:01,097 --> 01:10:03,464
而且我们会保存，但是

1331
01:10:03,533 --> 01:10:08,269
那么我们会说解雇（动画）。所以

1332
01:10:08,338 --> 01:10:11,939
解雇（动画：真）是你如何解雇自己。

1333
01:10:12,008 --> 01:10:14,642
如果你已经出席，你可以解雇你自己。

1334
01:10:14,711 --> 01:10:17,178
这也有一个完成处理程序，和

1335
01:10:17,246 --> 01:10:20,681
在那个完成处理程序中，我要关闭了。所以

1336
01:10:20,750 --> 01:10:23,250
我要等到我被解雇了。动画有

1337
01:10:23,319 --> 01:10:26,587
发生了，然后我会关闭我的文档。而且当然，

1338
01:10:26,656 --> 01:10:31,059
现在我正在关闭，所以我可以说，自我。所以让我们试试。

1339
01:10:45,107 --> 01:10:47,742
所以在这里我要再次打开Untitled。

1340
01:10:47,811 --> 01:10:49,576
现在我要关闭它，我回到了这里，

1341
01:10:49,645 --> 01:10:51,446
现在我要创建一个文档，准备好了吗？

1342
01:10:51,514 --> 01:10:54,681
创建，它复制该模板，它是空白的。

1343
01:10:54,750 --> 01:10:57,085
现在我要在这里拖一个文件，

1344
01:10:57,153 --> 01:10:59,953
让我们看看我们能否在这里找到好的东西，

1345
01:11:00,022 --> 01:11:05,158
类似的东西。把一个苹果放在树上，我会说，

1346
01:11:05,227 --> 01:11:10,498
像那样。现在，我要去了，我只会注意到它

1347
01:11:10,566 --> 01:11:14,368
已经改变了，我们应该自动做到这一点。和

1348
01:11:14,437 --> 01:11:17,838
那么我会说完成。现在我有两个文件，

1349
01:11:17,907 --> 01:11:20,574
现在我可以回到另一个，对吧？

1350
01:11:20,643 --> 01:11:23,711
点击那里，去这个，把那个，现在，

1351
01:11:23,779 --> 01:11:26,780
如果想将这些东西放在iCloud Drive上呢？

1352
01:11:26,849 --> 01:11:30,618
观看当我进入iCloud Drive表情符艺术时会发生什么，

1353
01:11:30,687 --> 01:11:32,486
创建文档，看，看。

1354
01:11:32,555 --> 01:11:34,889
我可以在iCloud Drive上创建文档。

1355
01:11:34,958 --> 01:11:37,958
所以这实际上是在网络上创建的，我可以

1356
01:11:38,027 --> 01:11:40,461
看到我所有的设备，所以在这里做另一个，

1357
01:11:40,529 --> 01:11:45,299
像这样的东西。在那里放一只蜜蜂，一只大蜜蜂，和

1358
01:11:45,367 --> 01:11:49,703
标记已保存，然后完成。现在我们有这个文件

1359
01:11:49,772 --> 01:11:52,140
这里没有标题，你看到的是iCloud Drive。

1360
01:11:52,208 --> 01:11:55,042
Se在我们的设备上仍然有Untitled，并且

1361
01:11:55,111 --> 01:11:58,479
我们在iCloud Drive上有一个。所以，我们点击它和

1362
01:11:58,547 --> 01:12:00,380
我们可以看到它。现在，

1363
01:12:00,449 --> 01:12:04,818
接下来我要做的就是让这个UI看起来像

1364
01:12:04,887 --> 01:12:09,289
好了很多。因为看那里的图标。我的意思是，

1365
01:12:09,358 --> 01:12:11,659
世界上最丑陋的图标是？我们要

1366
01:12:11,727 --> 01:12:13,861
从世界上最丑陋的图标走向世界

1367
01:12:13,930 --> 01:12:16,697
最好看的图标。由于使用UI文件，

1368
01:12:16,765 --> 01:12:20,535
你可以让每个文件都有自己的图标。和

1369
01:12:20,603 --> 01:12:23,303
我会把这个图标设为微缩版

1370
01:12:23,372 --> 01:12:25,405
文档，文档的缩略图。那

1371
01:12:25,474 --> 01:12:28,275
我可以很容易地看到哪一个是苹果和苹果之一

1372
01:12:28,344 --> 01:12:29,543
哪一个有蜜蜂。这将是，

1373
01:12:29,612 --> 01:12:30,511
我可以在这里看到它。

1374
01:12:30,580 --> 01:12:33,381
所以让我们来做。事实证明，这非常简单

1375
01:12:33,449 --> 01:12:35,883
在UI文档中。所以我要回到我的表情符号艺术

1376
01:12:35,951 --> 01:12:38,486
文件在这里。这个简单的家伙。和

1377
01:12:38,554 --> 01:12:43,124
我只是要添加一个方法，我会重写。

1378
01:12:43,192 --> 01:12:46,260
将文件属性称为正确。这基本上是

1379
01:12:46,328 --> 01:12:48,896
只是返回文件属性的字典，

1380
01:12:48,964 --> 01:12:51,799
就像这个文件隐藏了那些东西。所以

1381
01:12:51,867 --> 01:12:54,001
我将从我的超级课程中获得这些属性，

1382
01:12:54,070 --> 01:12:55,069
因为我重写了这个。

1383
01:12:55,138 --> 01:12:58,306
所以当你得到这个，然后我会添加一个属性

1384
01:12:58,374 --> 01:13:00,908
这是一个有点复杂的东西叫

1385
01:13:00,976 --> 01:13:03,978
一个thumbnailDictionaryKey。其实价值是另一回事

1386
01:13:04,046 --> 01:13:08,182
字典。你把这个钥匙放在这里，

1387
01:13:08,250 --> 01:13:10,618
Thumbnail1024x1024SizeKey。不要让这个骗过你。

1388
01:13:10,686 --> 01:13:13,020
它可以是任何你想要的尺寸。虽然如果它太小，

1389
01:13:13,089 --> 01:13:14,655
它会再次使用文档图标。所以

1390
01:13:14,724 --> 01:13:17,257
确保它足够大才能真正改进

1391
01:13:17,326 --> 01:13:19,860
在那。我需要在那里放一个缩略图。

1392
01:13:19,929 --> 01:13:22,863
所以我要添加一个变种来成为缩略图。

1393
01:13:22,932 --> 01:13:26,934
UIImage的。缩略图只是一个UIImage。和

1394
01:13:27,003 --> 01:13:29,770
现在我要在我的文档中设置这个缩略图

1395
01:13:29,838 --> 01:13:31,172
每次关闭。所以

1396
01:13:31,240 --> 01:13:34,007
当我关闭时，我只是想再拍一张照片。

1397
01:13:34,076 --> 01:13:36,310
所以让我们去做我的控制器。

1398
01:13:36,378 --> 01:13:41,348
我保存之后，我就在这里结束。我会说

1399
01:13:41,417 --> 01:13:46,587
我的documents.thumbnail =

1400
01:13:46,656 --> 01:13:52,126
myemojiArtview.snapshot。所以

1401
01:13:52,195 --> 01:13:56,130
快照是我写的一个小变量，我放入实用程序中。

1402
01:13:56,199 --> 01:13:58,665
你可以看看它。它只有三四行

1403
01:13:58,734 --> 01:14:02,102
代码只需要查看并快照它，并将其作为

1404
01:14:02,171 --> 01:14:06,107
一个UI图像。而且我只会顺便这么做，

1405
01:14:06,175 --> 01:14:09,343
再次，如果我的文档emojiArt不是没有。

1406
01:14:09,411 --> 01:14:11,645
因为我不想快照一个空白的文件。

1407
01:14:11,714 --> 01:14:14,615
但我应该在这里做的是快照和

1408
01:14:14,684 --> 01:14:18,552
那么如果这件事情是零，我应该拿出一些其他的

1409
01:14:18,621 --> 01:14:22,923
它的好缩略图。但我没有那样做。所以

1410
01:14:22,992 --> 01:14:26,861
让我们确保它在这里重建一切。所以

1411
01:14:26,929 --> 01:14:30,598
让我们再次运行。过来看看这个样子。

1412
01:14:32,635 --> 01:14:34,601
它实际上运行，尽管它说它有一个错误，

1413
01:14:34,670 --> 01:14:38,338
但它确实运行成功。好，如此

1414
01:14:38,407 --> 01:14:40,140
让我们打开我们的一个文件。

1415
01:14:40,209 --> 01:14:42,175
请记住，我们在关闭时设置缩略图，

1416
01:14:42,244 --> 01:14:45,947
所以这是一个。让我们继续并关闭它。和

1417
01:14:46,015 --> 01:14:48,416
看，我们得到这个美丽的缩略图。

1418
01:14:48,484 --> 01:14:49,983
这另一个在这里呢？

1419
01:14:50,052 --> 01:14:53,820
这家伙？让我们来关闭那个。而且这甚至可以工作

1420
01:14:53,889 --> 01:14:56,390
iCloud硬盘。它可能会在iCloud上稍微延迟一段时间

1421
01:14:56,458 --> 01:14:58,359
因为它必须上传它，所以我们试试吧。

1422
01:14:58,428 --> 01:15:01,395
让我们看看这里有多快，很快的网络。

1423
01:15:01,464 --> 01:15:03,864
我不知道你是否可以在iCloud驱动器中看到，

1424
01:15:03,932 --> 01:15:06,767
它实际上有简短的小云符号

1425
01:15:06,836 --> 01:15:08,368
它是从它下载回来的

1426
01:15:08,437 --> 01:15:10,104
这是一种很酷的云。

1427
01:15:10,172 --> 01:15:13,808
在这里你看到的UI是所有完整的文件UI。

1428
01:15:13,876 --> 01:15:17,511
所以你不仅可以像我在检查之前那样做事情

1429
01:15:17,580 --> 01:15:19,846
信息，但你可以移动它，

1430
01:15:19,915 --> 01:15:23,984
就像我可以将其从我的iCloud移回本地设备一样

1431
01:15:24,053 --> 01:15:26,754
或者我在这里复制。它在这里问我是否想要

1432
01:15:26,823 --> 01:15:29,055
保持两个或替换它因为他们都被称为无题，

1433
01:15:29,124 --> 01:15:32,292
所以我会保持两个。所以现在如果我回到我的iPad，现在我

1434
01:15:32,361 --> 01:15:35,162
有三个项目，包括这里的一个。然后再次，

1435
01:15:35,231 --> 01:15:38,432
有时当你从iCloud移动东西的时候你会得到延迟，

1436
01:15:38,501 --> 01:15:40,834
获取缩略图，

1437
01:15:40,903 --> 01:15:43,737
因为缩略图有时候会很大。所以

1438
01:15:43,806 --> 01:15:45,806
在他们周围肆虐可能需要一点时间

1439
01:15:45,875 --> 01:15:49,009
那里。你也可以重命名你的文件，所以

1440
01:15:49,078 --> 01:15:53,346
你知道，这是天空中的苹果。所以让我们重新命名它，

1441
01:15:53,415 --> 01:15:58,418
我们称之为天空苹果。所以你可以重命名你的文件，

1442
01:15:58,487 --> 01:16:01,488
所有的东西。用户可以在这里没有

1443
01:16:01,557 --> 01:16:05,225
必须转到文件应用程序来做到这一点。

1444
01:16:05,294 --> 01:16:07,160
我还剩几分钟，所以我是

1445
01:16:07,229 --> 01:16:10,164
会告诉你另外一件事情正在运行

1446
01:16:10,232 --> 01:16:14,068
苹果手机。所以让我们在iPhone上运行它。

1447
01:16:14,137 --> 01:16:17,171
我只是要去模拟器iPhone X中运行它，

1448
01:16:17,239 --> 01:16:22,709
让我们来看看iPhone X中的外观。所以

1449
01:16:22,778 --> 01:16:26,747
这整个文档视图浏览器，它一切正常

1450
01:16:26,815 --> 01:16:30,551
在iPhone中，就像它在iPad上一样。只有

1451
01:16:30,620 --> 01:16:32,986
当我们尝试和尝试时，我们必须考虑一些事情

1452
01:16:33,055 --> 01:16:36,156
让这个应用程序在iPhone上工作，你会看到这里。

1453
01:16:36,225 --> 01:16:39,292
一旦这被激发起来。所以它就是这样。看，你可以，

1454
01:16:39,361 --> 01:16:41,962
我们可以在这里查看iCloud Drive。

1455
01:16:42,031 --> 01:16:44,698
我们甚至可以看到我们创建的文档

1456
01:16:44,767 --> 01:16:49,469
之前在iCloud Drive上。而在开放的最后，我们可以开放东西

1457
01:16:49,538 --> 01:16:53,807
关闭iCloud Drive。所以我可以打开它。现在在iPhone上，我会的

1458
01:16:53,876 --> 01:16:57,377
真的很想仍然能够拖动一些表情符号和

1459
01:16:57,446 --> 01:17:01,115
在这个文件上工作，对。不过，我不能做的一件事，

1460
01:17:01,184 --> 01:17:03,817
是创建一个新的文件。你明白为什么？因为

1461
01:17:03,886 --> 01:17:07,821
iPhone，你不能从Safari拖拽拖拽新东西。

1462
01:17:07,890 --> 01:17:11,591
所以它在这里说创建文档是真的令人误解。

1463
01:17:11,660 --> 01:17:13,694
因为如果我点击创建文档，

1464
01:17:13,763 --> 01:17:16,196
我无法真正创建一个实际的文档，

1465
01:17:16,265 --> 01:17:19,232
因为我不能拖东西。所以我真的不想要它

1466
01:17:19,301 --> 01:17:22,336
在iPhone上说创建文档。另一件事是，

1467
01:17:22,405 --> 01:17:27,074
我想让我的集合视图起作用。我不能拖。我尝试着

1468
01:17:27,143 --> 01:17:30,144
推下去。为什么拖动不起作用？好，

1469
01:17:30,213 --> 01:17:32,746
拖动不起作用，因为默认情况下为集合视图

1470
01:17:32,815 --> 01:17:35,982
在iPhone上不允许拖动。但我们可以把它变成现实

1471
01:17:36,051 --> 01:17:38,485
上。所以让我们在我们的代码中解决这两个问题。

1472
01:17:38,554 --> 01:17:41,454
我们要解决这个问题

1473
01:17:41,523 --> 01:17:45,425
这个部分就是我们去的地方

1474
01:17:45,494 --> 01:17:48,762
创建模板。我只是不会在iPhone上做到这一点。

1475
01:17:48,831 --> 01:17:51,431
所以我是，那会让这是虚假的，而且

1476
01:17:51,500 --> 01:17:53,367
那么，如何检查我的代码以查看我是否在iPad上？和

1477
01:17:53,368 --> 01:17:55,235
它不是这样做的。

1478
01:17:55,304 --> 01:18:00,206
你这样做。你说如果UIDevice.current，

1479
01:18:00,275 --> 01:18:03,644
这是我目前的设备，

1480
01:18:03,713 --> 01:18:10,383
有一个userInterfaceIdiom

1481
01:18:10,452 --> 01:18:14,187
的.pad。另一种选择是

1482
01:18:14,256 --> 01:18:17,724
.phone所以我只会做这个模板的事情，这是

1483
01:18:17,793 --> 01:18:20,527
唯一可以在iPad上将其设置为true。

1484
01:18:20,596 --> 01:18:23,030
所以我永远不会在iPhone上创建文档。

1485
01:18:23,099 --> 01:18:23,831
那很好。

1486
01:18:23,900 --> 01:18:26,233
现在，怎么拖动集合视图？

1487
01:18:26,302 --> 01:18:29,536
那么，这是在我的控制器。我要去这里

1488
01:18:29,605 --> 01:18:32,373
到我创建我的集合视图的位置。这是我的

1489
01:18:32,441 --> 01:18:34,641
收集查看这里的出口。我会定下来的

1490
01:18:34,710 --> 01:18:39,112
Collection View中的这个东西叫做draginteractionenabled。

1491
01:18:39,181 --> 01:18:43,717
现在这在iPad上默认为true。并且默认为false

1492
01:18:43,786 --> 01:18:45,819
我的iPhone。但如果我在任何地方都把它设定为真，

1493
01:18:45,887 --> 01:18:46,854
现在它会如此

1494
01:18:46,922 --> 01:18:49,656
我也可以将我的集合vew拖拽到iPhone上。

1495
01:18:49,725 --> 01:18:53,861
所以当我们到这里时，我们不会看到创建按钮和

1496
01:18:53,930 --> 01:18:57,431
我们也将能够处理我们的文档。

1497
01:19:02,104 --> 01:19:04,071
所以让我们在这里打开这个文件。这里是。

1498
01:19:04,139 --> 01:19:08,408
现在看，我可以拖动。拖动我的集合视图和

1499
01:19:08,477 --> 01:19:10,910
我也可以把事情从这里拉出来

1500
01:19:10,979 --> 01:19:14,948
进入我的照片。我可以将它标记为已保存并完成，并且

1501
01:19:15,017 --> 01:19:17,985
如果我想让它回到我的iPad上，我将能够看到它

1502
01:19:18,053 --> 01:19:21,421
那里。所以我要做的只有两件事，就是讲演

1503
01:19:21,490 --> 01:19:23,957
在这里，你不会看到我做的

1504
01:19:24,026 --> 01:19:26,694
是代表团的事情。所以我们不必这样做

1505
01:19:26,762 --> 01:19:29,362
有保存按钮了，因为我们讨厌这个和

1506
01:19:29,431 --> 01:19:32,632
还增加了新型的表情符号艺术。其实只有两个

1507
01:19:32,701 --> 01:19:35,769
我会改变的事情。我要添加表情符艺术的东西

1508
01:19:35,838 --> 01:19:38,805
在那个我正在告诉你的环境中。

1509
01:19:38,874 --> 01:19:40,941
然后我会在这里改变这个权利，

1510
01:19:41,010 --> 01:19:44,444
我的空模板是无标题点表情符号艺术。那是

1511
01:19:44,513 --> 01:19:47,281
只有改变我才会使它成为使用表情符号的艺术

1512
01:19:47,349 --> 01:19:52,519
文件而不是JSON。好吧。这就对了。一世

1513
01:19:52,588 --> 01:19:55,255
下周一将会见到你。 >>为

1514
01:19:55,324 --> 01:19:59,126
更多，请访问我们的stanford.edu

